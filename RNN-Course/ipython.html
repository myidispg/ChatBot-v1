<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Ubuntu Mono'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Python 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IPython 7.2.0 -- An enhanced Interactive Python.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">1</span><span style=" color:#00ff00;">]:</span> sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-1-e5cc471d39a6&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">1</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    sentences, word2idx = get_robert_frost()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">NameError:</span> name 'get_robert_frost' is not defined</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">2</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">2</span><span style=" color:#00ff00;">]:</span> import theano</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano.tensor as T</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import numpy as np</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import matplotlib.pyplot as plt</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from sklearn.utils import shuffle</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from util import init_weight, get_robert_frost</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">3</span><span style=" color:#00ff00;">]:</span> sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-3-e5cc471d39a6&gt;&quot;</span>, line <span style=" color:#006400;">1</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sentences, word2idx = get_robert_frost()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;/home/myidispg/My Files/Machine-Learning-Projects/NLP Projects git/RNN-Course/util.py&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">54</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">get_robert_frost</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    for line in open('../hmm_class/robert_frost.txt'):</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">FileNotFoundError:</span> [Errno 2] No such file or directory: '../hmm_class/robert_frost.txt'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">4</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">4</span><span style=" color:#00ff00;">]:</span> sentences, word2idx = get_robert_frost()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">5</span><span style=" color:#00ff00;">]:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-5-481e0ff70d54&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">1</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    train_poetry()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">NameError:</span> name 'train_poetry' is not defined</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">6</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">6</span><span style=" color:#00ff00;">]:</span> def train_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN(30, 30, len(word2idx))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=2)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.save('poetry_model/RNN_D30_M30_epochs2000_relu.npz')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.generate(pi, word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-6-035a2c4241d7&gt;&quot;</span>, line <span style=" color:#006400;">22</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    train_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-6-035a2c4241d7&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">3</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">train_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    rnn = SimpleRNN(30, 30, len(word2idx))</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">NameError:</span> name 'SimpleRNN' is not defined</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">7</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">7</span><span style=" color:#00ff00;">]:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> Created on Thu Mar  7 20:21:15 2019</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> @author: myidispg</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano.tensor as T</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import numpy as np</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import matplotlib.pyplot as plt</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from sklearn.utils import shuffle</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from util import init_weight, get_robert_frost</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> class SimpleRNN:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def __init__(self, D, M, V):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.D = D # Dimensionality of word embeddings</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.M = M # No. of hidden layers</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.V = V # Vocabulary size</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def fit(self, X, learning_rate=10e-1, mu=0.99, reg=1.0, activation=T.tanh, epochs=500, show_fig = False):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         N = len(X) # Number of training samples.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         D = self.D</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         M = self.M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V = self.V</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         # inital weights</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         We = init_weight(V, D)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wx = init_weight(D, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wh = init_weight(M, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bh = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         h0 = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wo = init_weight(M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bo = np.zeros(V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         cost = -T.mean(T.log(py_x[T.arange(thY.shape[0]), thY]))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         grads = T.grad(cost, self.params)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         dparams = [theano.shared(p.get_value()*0) for p in self.params]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         updates = [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 (p, p + mu*dp -  learning_rate*g) for p, dp, g in zip(self.params, dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             ] + [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     (dp, mu*dp - learning_rate*g) for dp, g in zip(dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.predict_op = theano.function(input=[thX], outputs=prediction)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.train_op = theano.function(inputs=[thX, thY], outputs=[cost, prediction], updates=updates)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         costs = []</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         n_total = sum((len(sentence) + 1) for sentence in X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         for i in range(epochs):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             X = shuffle(X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             n_correct = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             cost = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             for j in range(N):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 input_sequence = [0] + X[j]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 output_sequence = X[j] + [1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 c, p = self.train_op(input_sequence, output_sequence)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 cost += c</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 for pj, xj in zip(p, output_sequence):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     if pj == xj:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                         n_correct += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             print(f'epoch: {i}, cost: {cost}, correct_rate: {float(n_correct) / n_total}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             costs.append(cost)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         if show_fig:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             plt.plot(costs)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             plt.show()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def save(self, filename):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         @staticmethod</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def load(filename, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             npz = np.load(filename)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             We = npz['arr_0']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Wx = npz['arr_1']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Wh = npz['arr_2']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             bh = npz['arr_3']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             h0 = npz['arr_4']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Wo = npz['arr_5']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             bo = npz['arr_6']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             V, D = We.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             _, M = Wx.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             rnn = SimpleRNN(D, M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             return rnn</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def set_params(self, We, Wx, Wh, bh, h0, Wo, bo, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 )   </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.predict_op = theano.function(input=[thX], outputs=prediction, allow_input_downcast=True)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def generate(self, pi, word2idx):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         idx2word = {v:k for k, v in word2idx.iteritems()}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V = len(pi)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         n_lines = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         X = [ np.random.choice(V, p=pi)]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         print(idx2word[X[0]])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         while n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             P = self.predict_op(X)[-1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             X += [P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             if P &gt; 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 word = idx2word[P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             elif P == 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_lines += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 print('')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 if n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     X = [np.random.choice(V, p=pi) ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def train_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN(30, 30, len(word2idx))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=2)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.save('poetry_model/RNN_D30_M30_epochs2000_relu.npz')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.generate(pi, word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:53: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-7-8b2544c76a41&gt;&quot;</span>, line <span style=" color:#006400;">200</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    train_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-7-8b2544c76a41&gt;&quot;</span>, line <span style=" color:#006400;">182</span>, in <span style=" color:#9400d3;">train_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=2)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-7-8b2544c76a41&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">75</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">fit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    self.predict_op = theano.function(input=[thX], outputs=prediction)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">TypeError:</span> function() got an unexpected keyword argument 'input'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">8</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">8</span><span style=" color:#00ff00;">]:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> Created on Thu Mar  7 20:21:15 2019</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> @author: myidispg</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano.tensor as T</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import numpy as np</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import matplotlib.pyplot as plt</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from sklearn.utils import shuffle</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from util import init_weight, get_robert_frost</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> class SimpleRNN:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def __init__(self, D, M, V):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.D = D # Dimensionality of word embeddings</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.M = M # No. of hidden layers</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.V = V # Vocabulary size</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def fit(self, X, learning_rate=10e-1, mu=0.99, reg=1.0, activation=T.tanh, epochs=500, show_fig = False):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         N = len(X) # Number of training samples.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         D = self.D</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         M = self.M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V = self.V</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         # inital weights</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         We = init_weight(V, D)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wx = init_weight(D, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wh = init_weight(M, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bh = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         h0 = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wo = init_weight(M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bo = np.zeros(V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         cost = -T.mean(T.log(py_x[T.arange(thY.shape[0]), thY]))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         grads = T.grad(cost, self.params)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         dparams = [theano.shared(p.get_value()*0) for p in self.params]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         updates = [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 (p, p + mu*dp -  learning_rate*g) for p, dp, g in zip(self.params, dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             ] + [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     (dp, mu*dp - learning_rate*g) for dp, g in zip(dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.predict_op = theano.function(inputs=[thX], outputs=prediction)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.train_op = theano.function(inputs=[thX, thY], outputs=[cost, prediction], updates=updates)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         costs = []</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         n_total = sum((len(sentence) + 1) for sentence in X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         for i in range(epochs):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             X = shuffle(X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             n_correct = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             cost = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             for j in range(N):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 input_sequence = [0] + X[j]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 output_sequence = X[j] + [1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 c, p = self.train_op(input_sequence, output_sequence)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 cost += c</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 for pj, xj in zip(p, output_sequence):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     if pj == xj:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                         n_correct += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             print(f'epoch: {i}, cost: {cost}, correct_rate: {float(n_correct) / n_total}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             costs.append(cost)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         if show_fig:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             plt.plot(costs)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             plt.show()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def save(self, filename):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         @staticmethod</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def load(filename, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             npz = np.load(filename)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             We = npz['arr_0']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Wx = npz['arr_1']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Wh = npz['arr_2']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             bh = npz['arr_3']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             h0 = npz['arr_4']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Wo = npz['arr_5']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             bo = npz['arr_6']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             V, D = We.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             _, M = Wx.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             rnn = SimpleRNN(D, M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             return rnn</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def set_params(self, We, Wx, Wh, bh, h0, Wo, bo, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 )   </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             self.predict_op = theano.function(input=[thX], outputs=prediction, allow_input_downcast=True)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def generate(self, pi, word2idx):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         idx2word = {v:k for k, v in word2idx.iteritems()}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V = len(pi)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         n_lines = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         X = [ np.random.choice(V, p=pi)]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         print(idx2word[X[0]])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         while n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             P = self.predict_op(X)[-1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             X += [P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             if P &gt; 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 word = idx2word[P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             elif P == 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_lines += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 print('')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 if n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     X = [np.random.choice(V, p=pi) ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def train_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN(30, 30, len(word2idx))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=2)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.save('poetry_model/RNN_D30_M30_epochs2000_relu.npz')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.generate(pi, word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:53: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/tensor/subtensor.py:2197: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  rval = inputs[0].__getitem__(inputs[1:])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 0, cost: 10834.394940372713, correct_rate: 0.11603028308097432</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 1, cost: 9336.525011522708, correct_rate: 0.11816984858459513</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAYcAAAD8CAYAAACcjGjIAAAACXBIWXMAAAsS
AAALEgHS3X78AAAAO3pUWHRTb2Z0d2FyZQAACJnLTSwpyMkvyclMUihLLSrO
zM9TMNYz0DPUUcgoKSmw0tfPhSvQyy9K1wcApuwQ8CLGD4IAACAASURBVHic
7d17XJR13v/x1wWDB9QQVBQcPMBMpiCYDoonSHFC3cJSM6pNTIvykKXtne29
a3fu1i7VrodMLdQMO2hlKeYB0CxQU3EkzyaTh4QJ5ej5gMj390f3bx55Iwtx
Gg6f51/rd66ZeX+3ut7OXDOf0ZRSCiGEEOI3nBwdQAghRN0j5SCEEKIUKQch
hBClSDkIIYQoRcpBCCFEKVIOQgghSpFyEEIIUYqUgxBCiFKkHIQQQpSic3SA
ymrbti1dunRxdAwhhKhXTp8+TV5eXrnH1dty6NKlCxaLxdExhBCiXjGZTBU6
Tt5WEkIIUYqUgxBCiFKkHIQQQpQi5SCEEKIUKQchhBClSDkIIYQoRcpBCCFE
KY2uHFbuOk1KRq6jYwghRJ1Wb78EVxk3b5Xw6Z4z/Hj2EmN665n9QHdauzZx
dCwhhKhzyn3lMHHiRDw9PQkICLCvFRQUYDabMRqNmM1mCgsLAbhw4QIPPvgg
QUFB+Pv7s2LFCvt94uPjMRqNGI1G4uPj7ev79u2jZ8+eGAwGpk+fjlKqOvd3
GxdnJ9ZNHci0IQbW7bcxbG4qmw9l19jzCSFEfVVuOUyYMIHExMTb1mJjYwkP
D8dqtRIeHk5sbCwAixYtokePHhw4cIDvvvuOl156iaKiIgoKCpgzZw579uwh
LS2NOXPm2Atl8uTJxMXFYbVasVqtpZ6rujVzceZPEd1YP20g7e9qyuRP0nnu
o33kXLxeo88rhBD1SbnlEBoaioeHx21rCQkJREdHAxAdHc26desA0DSNS5cu
oZTi8uXLeHh4oNPpSEpKwmw24+Hhgbu7O2azmcTERLKzs7l48SL9+/dH0zTG
jx9vf6ya5u/tRsLUgcwafg/bjucwbG4Kn1sya/SVixBC1BeVuiB97tw5vLy8
APDy8iInJweAadOmcezYMby9venZsycLFizAyckJm82Gj4+P/f56vR6bzYbN
ZkOv15dary06Zycm3+fH5hcG061DK15ec5DxH6SRWXC11jIIIURdVK2fVkpK
SqJXr1788ssv7N+/n2nTpnHx4sU7/m1c07Qy18sSFxeHyWTCZDKRm1t9nzjy
a9eSz2L68/dR/qT/XEjE/FRW7DzFrRJ5FSGEaJwqVQ7t27cnO/vXC7nZ2dl4
enoCsGLFCkaPHo2maRgMBrp27cqPP/6IXq8nMzPTfv+srCy8vb3R6/VkZWWV
Wi9LTEwMFosFi8VCu3btKhO9TE5OGk/270LyzDCCu3gw5+ujjHt/Fz/lXKrW
5xFCiPqgUuUQGRlp/8RRfHw8o0aNAqBTp0588803wK9vPR0/fhxfX18iIiJI
Tk6msLCQwsJCkpOTiYiIwMvLi1atWrF7926UUqxcudL+WI7SsXVzPnwqmLnj
gjiRe5mRC3bw7jYrN2+VODSXEELUKlWOqKgo1aFDB6XT6VTHjh3VsmXLVF5e
nho6dKgyGAxq6NChKj8/XymllM1mU2azWQUEBCh/f3/10Ucf2R9n+fLlys/P
T/n5+akPPvjAvr53717l7++vfH191dSpU1VJSUl5kZRSSvXp06dCx1VFzsXr
ason+1TnWRvU8Pmp6mDm+Rp/TiGEqEkVPXdqStXPj+eYTKZa+yW4pCNn+eu6
wxRcKeKZwb68OMxIMxfnWnluIYSoThU9dza68RmVEeHfga0zwhjbW897KScY
sWA7e07mOzqWEELUGCmHCnJzdeHNsYF8PKkfN2+V8GjcbmavO8yl6zcdHU0I
IaqdlMPvNMjYluQZoUwc2JWP9/xMxLxUvj2e4+hYQghRraQcKsG1iY5XH+zB
l5MH0KKpjqdW7GXGZ/spuFLk6GhCCFEtpByqoHcndzZMH8T0oQa+PvAL5rkp
bDj4i4zgEELUe1IOVdRU58zM+7vx9fOD8G7dnGmf/kDMR/s4J4P8hBD1mJRD
NenudRdrpwzgzyPuITUjl2FzU/hs7xl5FSGEqJekHKqRztmJZ8P8SHwxlO5e
dzHry0M8sWwPZ/JlkJ8Qon6RcqgBXdu2YPUzIbzxcAAHsy4QMT+V5TtkkJ8Q
ov6QcqghTk4aT/TrzJaZofT3a8PfNxxlzJLvyTgng/yEEHWflEMN83JrzvJo
EwuievFz/hX+8M52Fmy1UlQsg/yEEHWXlEMt0DSNUb06snVmGMMDvJi3NYPI
d3dwIPO8o6MJIcQdSTnUojYtm7LwsXtZOt5E4dUiHl68k39sOsa1oluOjiaE
ELeRcnAAc4/2bJkZxqPBnYhLPcmIBansOiGD/IQQdYeUg4Pc1cyFf47uyafP
9EMBjy3dzX+vPcRFGeQnhKgDpBwcbIBfWxJfCOWZwV1ZnXaG++em8s2xc46O
JYRo5KQc6oDmTZz5yx968NWUgbg1d2FSvIXpq34g//INR0cTQjRSUg51SC+f
1nz9/CBeHGZk8+FszPNSSdhvkxEcQohaV245TJw4EU9PTwICAuxrBQUFmM1m
jEYjZrOZwsJC+23fffcdvXr1wt/fn7CwMPt6YmIi3bp1w2AwEBsba18/deoU
/fr1w2g08uijj1JU1LjHXjfROfHisLvZ8PxgfDxceWH1fp6Ot5B94Zqjowkh
GpFyy2HChAkkJibethYbG0t4eDhWq5Xw8HD7yf78+fNMmTKF9evXc+TIEb74
4gsAbt26xdSpU9m8eTNHjx5l1apVHD16FIBZs2YxY8YMrFYr7u7uLF++vLr3
WC9169CKryYP4K9/6M7OE3ncPzeVT/ecoURGcAghakG55RAaGoqHh8dtawkJ
CURHRwMQHR3NunXrAPj0008ZPXo0nTp1AsDT0xOAtLQ0DAYDvr6+NGnShKio
KBISElBKsW3bNsaOHVvqsQQ4O2k8PdiXpBdDCejoxn+vPcTjy3ZzOu+Ko6MJ
IRq4Sl1zOHfuHF5eXgB4eXmRk/Prz2RmZGRQWFjIfffdR58+fVi5ciUANpsN
Hx8f+/31ej02m438/Hxat26NTqe7bb0scXFxmEwmTCYTubm5lYleL3Vu04JP
n+lH7OieHLFdZPiCVJamnqT4lozgEELUDF11PlhxcTH79u3jm2++4dq1a/Tv
35+QkJA7XlDVNK3M9bLExMQQExMDgMlkqr7g9YCmaUT17cR93Tz567pDvLHp
GBsO/sKbYwO5p8Ndjo4nhGhgKvXKoX379mRnZwOQnZ1tf/tIr9czfPhwWrRo
Qdu2bQkNDeXAgQPo9XoyMzPt98/KysLb25u2bdty/vx5iouLb1sXZevg1oyl
400sfOxesgqv8cA7O5i7JYMbxTKCQwhRfSpVDpGRkcTHxwMQHx/PqFGjABg1
ahTbt2+nuLiYq1evsmfPHrp3705wcDBWq5VTp05RVFTE6tWriYyMRNM0hgwZ
wpo1a0o9liibpmk8GOTNlplhPBDoxTvfWHlw4Q5+OFNY/p2FEKIiVDmioqJU
hw4dlE6nUx07dlTLli1TeXl5aujQocpgMKihQ4eq/Px8+/FvvfWW6t69u/L3
91fz5s2zr2/cuFEZjUbl6+urXn/9dfv6iRMnVHBwsPLz81Njx45V169fLy+S
UkqpPn36VOi4xuCbY2dVyD+2qi6vbFB/+/qIunLjpqMjCSHqqIqeOzWl6uc3
rEwmExaLxdEx6oxL12/yZuKPfLz7DJ08XIkd3ZMBhraOjiWEqGMqeu6Ub0g3
EK2aufD6Qz1ZHROCkwaPL9vDK18e5MI1GeQnhPj9pBwamBDfNiS+GMqzYb58
bsnEPDeF5CNnHR1LCFHPSDk0QM1cnPnziO6smzoQjxZNiPloH9M+TSdPBvkJ
ISpIyqEBC9S3Zv20QbxkvpvkI+cYNjeFtT9kySA/IUS5pBwauCY6J54PN7Jx
+iC6tm3BjM8OMPHDvfxyXgb5CSHKJuXQSBjbt2LNcwN49YEe7D5ZwP3zUvlo
988yyE8IcUdSDo2Is5PGxEFdSZ4RSi+f1sxed5iouN2czL3s6GhCiDpGyqER
8vFw5aNJfXlrTCDHzl5kxILtvJdyQgb5CSHspBwaKU3TGBfsw9aZYYTd3Y7Y
zT/y0OKdHP3loqOjCSHqACmHRq79Xc14/8k+LH6iN2cvXCfy3R38O/m4DPIT
opGTchBomsbInl5smRFGZC9vFm77iT+8s4N9P8sgPyEaKykHYefeoglzx/Xi
w6eCuVZ0i7Hvfc+cr49w5Uaxo6MJIWqZlIMo5b5uniTNCOXJkM6s2HmaiPmp
bLc2nl/eE0JIOYgytGyq42+jAvj82f40cXbiyeVp/NcXB7hwVQb5CdEYSDmI
/6hvVw82vTCYKff58dUPNobNSyHxsAzyE6Khk3IQ5Wrm4szLw+8hYepA2rVs
ynMf72PKJ/vIuXTd0dGEEDVEykFUWEBHNxKmDeS/Irqx9VgO5rmpfLlPBvkJ
0RCVWw4TJ07E09OTgIAA+1pBQQFmsxmj0YjZbKaw8PaPPO7duxdnZ2f7b0PD
r78PbTQaMRqN9t+fBti3bx89e/bEYDAwffp0OdHUcS7OTkwdYmDT9MEYPFvy
0hcHiF6xl6zCq46OJoSoRuWWw4QJE0hMTLxtLTY2lvDwcKxWK+Hh4cTGxtpv
u3XrFrNmzSIiIsK+VlBQwJw5c9izZw9paWnMmTPHXiiTJ08mLi4Oq9WK1Wot
9VyibjJ4tuSLZ/szJ9Ify+lfB/nFf39aBvkJ0UCUWw6hoaF4eHjctpaQkEB0
dDQA0dHRrFu3zn7bwoULGTNmDJ6enva1pKQkzGYzHh4euLu7YzabSUxMJDs7
m4sXL9K/f380TWP8+PG3PZao25ycNKIHdCHpxVD6dHbnf9YfYdz7uzghg/yE
qPcqdc3h3LlzeHl5AeDl5UVOTg4ANpuNtWvX8txzz912vM1mw8fHx/5nvV6P
zWbDZrOh1+tLrYv6xcfDlZUT+/KvR4Kw5lxmxILtLPr2J27KID8h6q1qvSD9
4osv8uabb+Ls7Hzb+p2uI2iaVuZ6WeLi4jCZTJhMJnJz5UtZdYmmaYzto2fL
zFCGdffk7aTjPLRoJ4dtFxwdTQhRCZUqh/bt25OdnQ1Adna2/S0ki8VCVFQU
Xbp0Yc2aNUyZMoV169ah1+vJzMy03z8rKwtvb2/0ej1ZWVml1ssSExODxWLB
YrHQrl27ykQXNcyzVTMWP9GH9/7Ym3MXbzBq0U7eSvyR6zdlkJ8Q9UmlyiEy
MtL+iaP4+HhGjRoFwKlTpzh9+jSnT59m7NixLF68mIceeoiIiAiSk5MpLCyk
sLCQ5ORkIiIi8PLyolWrVuzevRulFCtXrrQ/lqjfhgd48c3MMEbf25HF351g
5ILt7D1d4OhYQogKKrccHnvsMfr378/x48fR6/UsX76cV155hS1btmA0Gtmy
ZQuvvPLKf3wMDw8PZs+eTXBwMMHBwbz66qv2i9xLlizh6aefxmAw4Ofnx4gR
I6pnZ8Lh3FxdePuRIFZO7MuN4hIeeW8XryYc5rIM8hOiztNUPf1igclkwmKx
ODqGqKArN4p5O+k48btO4+3WnH+M7knY3fLWoBC1raLnTvmGtKgVLZrqeC3S
nzXP9aeZixPRH6Qx8/P9nL9a5OhoQog7kHIQtapPZw82Th/MtCEG1u//hWFz
U9h0KNvRsYQQ/4eUg6h1zVyc+VNENxKmDaSDWzOmfJLOsx9ZyLkog/yEqCuk
HITD+Hu7sW7KQGYNv4dvj+cybG4Kn1syZb6WEHWAlINwKJ2zE5Pv8yPxhcHc
0+EuXl5zkCeXp5FZIIP8hHAkKQdRJ/i2a8nqmBD+/lAAP5wp5P55qazYeYpb
MshPCIeQchB1hpOTxpMhnUmeGUY/Xw/mfH2UR977np9yLjk6mhCNjpSDqHM6
tm7OignBzHs0iJN5Vxi5YAfvbrPKID8hapGUg6iTNE3j4Xv1bJ0Zhtm/Pf9K
zuDBhTs4lCWD/ISoDVIOok5r27Ipix7vzftP9qHgShGjFu3gn5uPySA/IWqY
lIOoFyL8O7BlZhjjTD68n3KSEQu2s+dkvqNjCdFgSTmIesOtuQuxYwL55Ol+
FJeU8Gjcbv667hCXrt90dDQhGhwpB1HvDDS0JenFUCYN6sone84QMS+Vb3/M
cXQsIRoUKQdRL7k20TH7gR58OXkALZrqeOrDvcz4bD8FV2SQnxDVQcpB1Gu9
O7mzYfogpocb+frAL5jnpvD1gV9kBIcQVSTlIOq9pjpnZprv5uvnB9HRvTnP
r/qBZ1bu45wM8hOi0qQcRIPR3esuvpo8gP8eeQ/brb8O8luddkZeRQhRCeWW
w8SJE/H09CQgIMC+VlBQgNlsxmg0YjabKSwsBOCTTz4hMDCQwMBABgwYwIED
B+z3SUxMpFu3bhgMBmJjY+3rp06dol+/fhiNRh599FGKiuQ9Y1F5OmcnYkL9
SHoxlB5ed/HKV4d4YtkezuTLID8hfo9yy2HChAkkJibethYbG0t4eDhWq5Xw
8HD7yb5r166kpKRw8OBBZs+eTUxMDAC3bt1i6tSpbN68maNHj7Jq1SqOHj0K
wKxZs5gxYwZWqxV3d3eWL19e3XsUjVCXti1Y9UwI/3i4JwezLnD//BSWbT8p
g/yEqKByyyE0NBQPD4/b1hISEoiOjgYgOjqadevWATBgwADc3d0BCAkJISsr
C4C0tDQMBgO+vr40adKEqKgoEhISUEqxbds2xo4dW+qxhKgqJyeNx/t1YsvM
UAb4teX1jccYs+R7jp+VQX5ClKdS1xzOnTuHl5cXAF5eXuTklP6M+fLlyxkx
YgQANpsNHx8f+216vR6bzUZ+fj6tW7dGp9Pdti5EdfJya87yaBMLonpxpuAq
DyzczvytGRQVyyA/Icqiq4kH/fbbb1m+fDk7duwAuOMFQU3TylwvS1xcHHFx
cQDk5uZWU1rRGGiaxqheHRlkaMvfNhxl/lYrmw+d5a2xgQT5tHZ0PCHqnEq9
cmjfvj3Z2b/+KHx2djaenp722w4ePMjTTz9NQkICbdq0AX59RZCZmWk/Jisr
C29vb9q2bcv58+cpLi6+bb0sMTExWCwWLBYL7dq1q0x00ci1admUBVH3smy8
iQvXbvLw4p28sfEo14pkkJ8Qv1WpcoiMjCQ+Ph6A+Ph4Ro0aBcCZM2cYPXo0
H330EXfffbf9+ODgYKxWK6dOnaKoqIjVq1cTGRmJpmkMGTKENWvWlHosIWrS
sB7tSZ4ZSlTfTizdforhC1LZdUIG+Qlhp8oRFRWlOnTooHQ6nerYsaNatmyZ
ysvLU0OHDlUGg0ENHTpU5efnK6WUmjRpkmrdurUKCgpSQUFBqk+fPvbH2bhx
ozIajcrX11e9/vrr9vUTJ06o4OBg5efnp8aOHauuX79eXiSllLrtsYWoip0/
5arQt7apzrM2qFe+PKguXCtydCQhakxFz52aUvXzG0ImkwmLxeLoGKKBuFZ0
i3lbM1i2/SSerZrx+kMBDOvR3tGxhKh2FT13yjekhQCaN3Hmv0d256spA3Fr
7sLTKy1MX/UD+ZdvODqaEA4h5SDEb/Tyac3Xzw9ixrC72Xw4m2FzU0jYb5MR
HKLRkXIQ4v9oonPihWFGNk4fTOc2LXhh9X6ejreQfeGao6MJUWukHIQow93t
W/Hl5AH89Q/d2XkiD/PcVD7Z8zMlMoJDNAJSDkL8B85OGk8P9iX5xTAC9W78
Ze1hHl+2m9N5VxwdTYgaJeUgRAV0auPKJ0/3I3Z0T47YLhIxP5W41BMU35IR
HKJhknIQooI0TSOqbye2zAxjsLEd/9j0I6OXfM+x7IuOjiZEtZNyEOJ36uDW
jKXj+/Du4/diK7zGgwt3MHdLBjeKZQSHaDikHISoBE3TeCDQm60zw3gwyJt3
vrHywDs7SD9T6OhoQlQLKQchqsC9RRPmPdqLFROCuXyjmDFLvufvG45ytajY
0dGEqBIpByGqwZB7PEmeEcoT/TqxfMcpIuansvOnPEfHEqLSpByEqCatmrnw
+kM9+SwmBJ2TE08s28OsNQe5cO2mo6MJ8btJOQhRzfr5tmHzC4N5LsyPNelZ
mOemkHzkrKNjCfG7SDkIUQOauTjzyoh7WDdlIG1aNiXmo31M/TSd3EsyyE/U
D1IOQtSgnno31k8byJ/uv5stR85hnpfC2h+yZJCfqPOkHISoYS7OTkwbamTT
C4PwbduCGZ8d4KkP92I7L4P8RN0l5SBELTF4tuKL5wbwPw/2YM/JAu6fm8JH
u07LID9RJ0k5CFGLnJ00nhrYleQZodzbyZ3ZCUeIitvNydzLjo4mxG3KLYeJ
Eyfi6elJQECAfa2goACz2YzRaMRsNlNY+Ou3QpVSTJ8+HYPBQGBgIOnp6fb7
xMfHYzQaMRqNxMfH29f37dtHz549MRgMTJ8+Xd6LFY2Cj4crH03qy1tjA/nx
7EWGL9jOku9kkJ+oO8othwkTJpCYmHjbWmxsLOHh4VitVsLDw4mNjQVg8+bN
WK1WrFYrcXFxTJ48Gfi1TObMmcOePXtIS0tjzpw59kKZPHkycXFx9vv93+cS
oqHSNI1xJh+2zgxjSLd2vJn4Iw8t3snRX2SQn3C8csshNDQUDw+P29YSEhKI
jo4GIDo6mnXr1tnXx48fj6ZphISEcP78ebKzs0lKSsJsNuPh4YG7uztms5nE
xESys7O5ePEi/fv3R9M0xo8fb38sIRoLz7ua8f6TJpY80ZuzF24Q+e4O/pV0
nOs3ZZCfcJxKXXM4d+4cXl5eAHh5eZGTkwOAzWbDx8fHfpxer8dms/3Hdb1e
X2q9LHFxcZhMJkwmE7m5uZWJLkSdNaKnF1tnhjKqV0fe/fYn/vDOdvb9XODo
WKKRqtYL0ne6XqBp2u9eL0tMTAwWiwWLxUK7du2qFlaIOqi1axP+PS6I+Il9
uX6zhLHv7eK19Ue4ckMG+YnaValyaN++PdnZ2QBkZ2fj6ekJ/Po3/8zMTPtx
WVlZeHt7/8f1rKysUutCNHZhd7cjaUYo40M6E7/rNPfPSyU1Q14ti9pTqXKI
jIy0f+IoPj6eUaNG2ddXrlyJUordu3fj5uaGl5cXERERJCcnU1hYSGFhIcnJ
yURERODl5UWrVq3YvXs3SilWrlxpfywhGruWTXXMGRXA58/2p6mLE+M/SONP
XxzgwlUZ5CdqgSpHVFSU6tChg9LpdKpjx45q2bJlKi8vTw0dOlQZDAY1dOhQ
lZ+fr5RSqqSkRE2ZMkX5+vqqgIAAtXfvXvvjLF++XPn5+Sk/Pz/1wQcf2Nf3
7t2r/P39la+vr5o6daoqKSkpL5JSSqk+ffpU6DghGoJrRcXqzc3HlO+fNyrT
61vU5kO/ODqSqKcqeu7UlKqfXywwmUxYLBZHxxCiVh22XeDlNQc5mn2REQEd
mDPKH89WzRwdS9QjFT13yjekhahHAjq6kTBtIP8V0Y1vfszBPDeVNftkkJ+o
flIOQtQzLs5OTB1iYNP0wRg9W/KnLw4w/oM0MguuOjqaaECkHISopwyeLfn8
2f78bZQ/6T8XEjE/lQ93npJBfqJaSDkIUY85OWmM79+FpBmhmLp48NrXRxn3
/i5+ypFBfqJqpByEaAD07q7EPxXMvx8JwppzmZELtrPo25+4KYP8RCVJOQjR
QGiaxpg+erbODGNYD0/eTjrOqHd3cth2wdHRRD0k5SBEA9OuVVMWP9GH9/7Y
m9zLNxi1aCdvJv4og/zE7yLlIEQDNTzAi60zwhjTuyNLvjvByAXb2XtaBvmJ
ipFyEKIBc3N14a2xQXw8qR9Ft0p45L1dvJpwmMsyyE+UQ8pBiEZgkLEtSS+G
8tTALny0+2ci5qXy3fEcR8cSdZiUgxCNRIumOv7nQX/WPDeA5k2cmbBiLzM/
30/hlSJHRxN1kJSDEI1Mn87ubJw+iOeHGli//xfM81LYdChbRnCI20g5CNEI
NdU589L93Vg/bRBebs2Z8kk6z328j5yL1x0dTdQRUg5CNGI9vO9i7ZQB/HnE
PXx3PJfwuSl8vjdTXkUIKQchGjudsxPPhvmx+YXBdPe6i5e/PMiTy2WQX2Mn
5SCEAMC3XUtWPxPC6w8FsD/zPPfPS+WDHae4JYP8GiUpByGEnZOTxh9DOpM8
I5R+vh78bcNRHnnve6znLjk6mqhlVSqHBQsWEBAQgL+/P/Pnzwdg//79hISE
0KtXL0wmE2lpaQAopZg+fToGg4HAwEDS09PtjxMfH4/RaMRoNNp/m1oI4Tje
rZuzYkIw8x/txam8K/zhnR0s/MYqg/wak8r+DumhQ4eUv7+/unLlirp586YK
Dw9XGRkZymw2q02bNimllNq4caMKCwuz/+/hw4erkpIStWvXLtW3b1+llFL5
+fmqa9euKj8/XxUUFKiuXbuqgoKCcp9ffkNaiNqRe+m6mvrJPtV51gYVMS9F
HcgsdHQkUQUVPXdW+pXDsWPHCAkJwdXVFZ1OR1hYGGvXrkXTNC5evAjAhQsX
8Pb2BiAhIYHx48ejaRohISGcP3+e7OxskpKSMJvNeHh44O7ujtlsJjExsXqa
TwhRZW1bNuXdx3sT92QfCq8W8dCinfxz0zEZ5NfA6Sp7x4CAAP7yl7+Qn59P
8+bN2bRpEyaTifnz5xMREcGf/vQnSkpK+P777wGw2Wz4+PjY76/X67HZbGWu
CyHqlvv9O9DPtw2xm4/xfupJko6cJXZMICG+bRwdTdSASr9y6N69O7NmzcJs
NjN8+HCCgoLQ6XQsWbKEefPmkZmZybx585g0aRLAHT83rWlamet3EhcXh8lk
wmQykZubW9noQohKcmvuwj9HB/Lp0/0oURAVt5u/rD3Epes3HR1NVLMqXZCe
NGkS6enppKam4uHhYb+gPHr0aAAeeeQR+wVpvV5PZmam/b5ZWVl4e3uXuX4n
MTExWCwWLBYL7dq1q0p0IUQVDDC0JfHFwTw9qCur0s5w/7xUvv1RBvk1JFUq
h5ycX/9lOHPmDF999RWPPfYY3t7epKSkALBt2zaMRiMAkZGRrFy5EqUUu3fv
4yOAmAAAEkdJREFUxs3NDS8vLyIiIkhOTqawsJDCwkKSk5OJiIio4raEEDXN
tYmOvz7Qgy8nD6BlUx1PfbiXF1f/QIEM8msQKn3NAWDMmDHk5+fj4uLCokWL
cHd3Z+nSpbzwwgsUFxfTrFkz4uLiABg5ciSbNm3CYDDg6urKihUrAPDw8GD2
7NkEBwcD8Oqrr+Lh4VHFbQkhasu9ndzZMH0Qi789weLvfmK7NY/XIv15INCr
zLeIRd2nqTu96V8PmEwmLBaLo2MIIX7jx7MXmbXmIAeyLjCse3tefyiADm7N
HB1L/EZFz53yDWkhRLW5p8NdfDVlIH8Z2Z0dP+VinpvCqrQzMsivHpJyEEJU
K2cnjWdCfUl8IRT/jnfx568O8fjSPfycf8XR0cTvIOUghKgRXdq24NOnQ/jH
wz05bLtAxPxUlm0/KYP86gkpByFEjXFy0ni8XyeSZ4Yy0K8tr288xugl33P8
rAzyq+ukHIQQNc7LrTnLok2889i9ZBZc5YGF25m/NYOiYhnkV1dJOQghaoWm
aUQGebN1Zhgje3oxf6uVBxfuYH/meUdHE3cg5SCEqFUeLZqwIOpelkebuHDt
JqMX7+SNjUe5ViSD/OoSKQchhEOEd29P8sxQovp2Yun2U0TMT+X7E3mOjiX+
l5SDEMJh7mrmwj8e7smqZ0LQNHh86R7+/NUhLsogP4eTchBCOFx/vzYkvhDK
s6G+fLb3DOa5KWw9es7RsRo1KQchRJ3QvIkzfx7ZnXVTB+Lu2oSnV1p4ftUP
5F++4ehojZKUgxCiTgnUt2b9tEHMNN9N4uFshs1NIWG/TUZw1DIpByFEndNE
58T0cCMbpw+mc5sWvLB6P5PiLfxy/pqjozUaUg5CiDrr7vat+HLyAGY/0INd
J/K5f14qn+z5mRIZwVHjpByEEHWas5PGpEFdSXoxlCAfN/6y9jCPLd3NqTwZ
5FeTpByEEPVCpzaufDypH2+O6cnR7IsMn5/K+yknKL4lIzhqgpSDEKLe0DSN
R4M7sXVmGKF3t+Ofm39k9JLvOZZ90dHRGpwqlcOCBQsICAjA39+f+fPn29cX
LlxIt27d8Pf35+WXX7av//Of/8RgMNCtWzeSkpLs64mJiXTr1g2DwUBsbGxV
IgkhGoH2dzUj7sk+LHq8N7+cv8aDC3cwN/k4N4plBEe1UZV06NAh5e/vr65c
uaJu3rypwsPDVUZGhtq2bZsKDw9X169fV0opde7cOaWUUkeOHFGBgYHq+vXr
6uTJk8rX11cVFxer4uJi5evrq06cOKFu3LihAgMD1ZEjR8p9/j59+lQ2uhCi
ASm4fEPNWP2D6jxrgxr27+/Uvp8LHB2pTqvoubPSrxyOHTtGSEgIrq6u6HQ6
wsLCWLt2LUuWLOGVV16hadOmAHh6egKQkJBAVFQUTZs2pWvXrhgMBtLS0khL
S8NgMODr60uTJk2IiooiISGheppPCNHgubdowtxHe7HiqWCu3ChmzJLv+dvX
R7laVOzoaPVapcshICCA1NRU8vPzuXr1Kps2bSIzM5OMjAy2b99Ov379CAsL
Y+/evQDYbDZ8fHzs99fr9dhstjLXhRDi9xjSzZOkGaH8sV9nPtj56yC/nT/J
IL/KqnQ5dO/enVmzZmE2mxk+fDhBQUHodDqKi4spLCxk9+7dvP3224wbNw6l
1B2/3ahpWpnrdxIXF4fJZMJkMpGbm1vZ6EKIBqpVMxf+/lAAnz/bH52TE08s
28OsNQe5cE0G+f1eVbogPWnSJNLT00lNTcXDwwOj0Yher2f06NFomkbfvn1x
cnIiLy8PvV5PZmam/b5ZWVl4e3uXuX4nMTExWCwWLBYL7dq1q0p0IUQD1rer
B5tfGMzk+/xYk56FeW4KSUfOOjpWvVKlcsjJyQHgzJkzfPXVVzz22GM89NBD
bNu2DYCMjAyKiopo27YtkZGRrF69mhs3bnDq1CmsVit9+/YlODgYq9XKqVOn
KCoqYvXq1URGRlZ9Z0KIRq2ZizOzht/DuikDadOyKc9+tI+pn6STe0kG+VWE
rip3HjNmDPn5+bi4uLBo0SLc3d2ZOHEiEydOJCAggCZNmhAfH4+mafj7+zNu
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
QQghRCn/D0DR5q+9xavgAAAAAElFTkSuQmCC
" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-8-ec90de660d17&gt;&quot;</span>, line <span style=" color:#006400;">200</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    train_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-8-ec90de660d17&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">183</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">train_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    rnn.save('poetry_model/RNN_D30_M30_epochs2000_relu.npz')</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">AttributeError:</span> 'SimpleRNN' object has no attribute 'save'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">9</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">9</span><span style=" color:#00ff00;">]:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> Created on Thu Mar  7 20:21:15 2019</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> @author: myidispg</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import theano.tensor as T</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import numpy as np</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> import matplotlib.pyplot as plt</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from sklearn.utils import shuffle</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> from util import init_weight, get_robert_frost</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> class SimpleRNN:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def __init__(self, D, M, V):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.D = D # Dimensionality of word embeddings</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.M = M # No. of hidden layers</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.V = V # Vocabulary size</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def fit(self, X, learning_rate=10e-1, mu=0.99, reg=1.0, activation=T.tanh, epochs=500, show_fig = False):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         N = len(X) # Number of training samples.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         D = self.D</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         M = self.M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V = self.V</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         # inital weights</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         We = init_weight(V, D)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wx = init_weight(D, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wh = init_weight(M, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bh = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         h0 = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wo = init_weight(M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bo = np.zeros(V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         cost = -T.mean(T.log(py_x[T.arange(thY.shape[0]), thY]))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         grads = T.grad(cost, self.params)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         dparams = [theano.shared(p.get_value()*0) for p in self.params]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         updates = [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 (p, p + mu*dp -  learning_rate*g) for p, dp, g in zip(self.params, dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             ] + [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     (dp, mu*dp - learning_rate*g) for dp, g in zip(dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.predict_op = theano.function(inputs=[thX], outputs=prediction)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.train_op = theano.function(inputs=[thX, thY], outputs=[cost, prediction], updates=updates)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         costs = []</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         n_total = sum((len(sentence) + 1) for sentence in X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         for i in range(epochs):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             X = shuffle(X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             n_correct = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             cost = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             for j in range(N):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 input_sequence = [0] + X[j]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 output_sequence = X[j] + [1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 c, p = self.train_op(input_sequence, output_sequence)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 cost += c</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 for pj, xj in zip(p, output_sequence):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     if pj == xj:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                         n_correct += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             print(f'epoch: {i}, cost: {cost}, correct_rate: {float(n_correct) / n_total}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             costs.append(cost)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         if show_fig:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             plt.plot(costs)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             plt.show()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def save(self, filename):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     @staticmethod</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def load(filename, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         npz = np.load(filename)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         We = npz['arr_0']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wx = npz['arr_1']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wh = npz['arr_2']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bh = npz['arr_3']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         h0 = npz['arr_4']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Wo = npz['arr_5']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         bo = npz['arr_6']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V, D = We.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         _, M = Wx.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         rnn = SimpleRNN(D, M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         return rnn</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def set_params(self, We, Wx, Wh, bh, h0, Wo, bo, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             )   </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         self.predict_op = theano.function(input=[thX], outputs=prediction, allow_input_downcast=True)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     def generate(self, pi, word2idx):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         idx2word = {v:k for k, v in word2idx.iteritems()}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         V = len(pi)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         n_lines = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         X = [ np.random.choice(V, p=pi)]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         print(idx2word[X[0]])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         while n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             P = self.predict_op(X)[-1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             X += [P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             if P &gt; 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 word = idx2word[P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>             elif P == 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 n_lines += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 print('')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                 if n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>                     X = [np.random.choice(V, p=pi) ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def train_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN(30, 30, len(word2idx))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=2)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.save('poetry_model/RNN_D30_M30_epochs2000_relu.npz')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span>     rnn.generate(pi, word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">   ...:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:53: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 0, cost: 10769.10725034114, correct_rate: 0.1162771560236998</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 1, cost: 9124.38021950489, correct_rate: 0.11816984858459513</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAYcAAAD8CAYAAACcjGjIAAAACXBIWXMAAAsS
AAALEgHS3X78AAAAO3pUWHRTb2Z0d2FyZQAACJnLTSwpyMkvyclMUihLLSrO
zM9TMNYz0DPUUcgoKSmw0tfPhSvQyy9K1wcApuwQ8CLGD4IAACAASURBVHic
7d15QFT1/j7w58AAigsCAg6iIosbw6KMihukOCpmoGmKehXDpNTSsFvee/va
1ZYb3W7uW6gVtmjumAuipQySiAOhggsTgiwhq4K5oMj5/eH3O7+4aCDbYeB5
/SVnzpx5PpnzcObMvEcQRVEEERHRHxhIHYCIiJoflgMREVXDciAiompYDkRE
VA3LgYiIqmE5EBFRNSwHIiKqhuVARETVsByIiKgamdQB6qpz586wt7eXOgYR
kV7JzMxEUVFRjfvpbTnY29tDo9FIHYOISK8olcpa7ceXlYiIqBqWAxERVcNy
ICKialgORERUDcuBiIiqYTkQEVE1LAciIqqmxnIIDg6GtbU1FAqFbltJSQlU
KhWcnZ2hUqlw8+ZNAMCnn34KDw8PeHh4QKFQwNDQECUlJQAefy7B1dUVHh4e
Vd5n+7RjNZZDF37DgV9ywW9HJSJ6uhrLYc6cOYiKiqqyLSwsDL6+vtBqtfD1
9UVYWBgA4O2330ZycjKSk5Px8ccfw8fHBxYWFrr7nTx5EsnJyVU+vPa0YzWW
vYk5ePP7ZMyN0OC3W/ca9bGIiPRVjeXg7e1d5QkeACIjIxEUFAQACAoKwoED
B6rdb8eOHZg+fXqNAWpzrIa0NWgglk3ohzPpxRizSo1v4q+jspJnEUREf1Sn
aw75+fmQy+UAALlcjoKCgiq33717F1FRUZg8ebJumyAIGDNmDDw9PREeHl7r
YzU0QwMBc4f3xLE3veHezQz/cyAFgVvikVF0p1Efl4hInzTKBekffvgBw4YN
q3LGERcXh6SkJBw9ehQbNmyAWq1+5uOGh4dDqVRCqVSisLCwXhm7W5rim7mD
8e/JbricV4Zxq9XYHJOOikeV9TouEVFLUKdysLGxQV5eHgAgLy8P1tbWVW7f
uXNntZeUbG1tAQDW1taYNGkSEhISanWsPwoJCYFGo4FGo4GVlVVdolchCAKm
DuyGE0t84N3LCmFHr2DSxp9x6beyeh+biEif1akc/P39ERERAQCIiIhAQECA
7rbS0lLExMRU2Xbnzh3cvn1b9+fo6Gjdu5/+7FhNxaZjG4TP8sSGGQOQV3oP
/utP47PoqyiveNTkWYiImoMaR3ZPnz4dp06dQlFREezs7LBixQr87W9/w9Sp
U7Ft2zZ0794du3fv1u2/f/9+jBkzBu3atdNty8/Px6RJkwAAFRUVmDFjBsaN
GwcAf3qspiQIAp53k2OooyU+OHQJ6376FUdTbuCTyW7w7GEuSSYiIqkIop6+
4V+pVDbq9zmcvFqAd/ddRF7ZfcwZao+3x/aGqbHefv0FERGA2j938hPSTzGy
tzWil/hgllcPfBmXiTGr1Ditrfnbk4iIWgKWw59obyLD+wEK7Hp1CIwMDfCX
bWfxzp7zKL37UOpoRESNiuVQC4N6WuDo4hGY/5wj9iblYvSqGESl3JA6FhFR
o2E51FIbI0MsHdcHBxYMQ+f2Jnjtm0Qs/DYJhbfLpY5GRNTgWA7PyNXODAdf
H4a3x/bG8Uv5GL0yBnsTczjIj4haFJZDHRgZGmDhSCccWTwCTtbt8dbu85jz
5Tnk3LwrdTQiogbBcqgHJ+v22P3qECx/oR/OZZZg7Co1tp/J5CA/ItJ7LId6
MjAQMGfY40F+A3qY473IVEwLP4P0wt+ljkZEVGcshwbSzcIU24MH4dMpbrh6
4zb81sRi46lf8ZCD/IhID7EcGpAgCHhJ2Q0n3vLBqN7W+HfUVUzcEIeU3FKp
oxERPROWQyOw7tAGm2d5YtPMAcgvK0fAhjh8euwK7j/kID8i0g8sh0bk5yrH
iSXemNS/KzacTMf4tbHQZJZIHYuIqEYsh0bWydQY/3nJHduDB6H8YSVe+vwM
/hmZgt/LK6SORkT0VCyHJuLdywrRod4IGmKP7fHXMXaVGjFp9fs2OyKixsJy
aELtTGRY7u+C3a8OgYmRAYK+SMBbu87j1t0HUkcjIqqC5SABpb0FjiwagddH
OuFAci5Gr1Tj6MU8qWMREemwHCTSxsgQfx3bGwdfHwabjiaY/20SXvs6EQVl
96WORkTEcpCai60ZIhcOw9JxffDT1QKMXhmD3ZpsDvIjIkmxHJoBmaEB5j/n
iKOLR6B3lw54e88FzP4iAdklHORHRNJgOTQjjlbt8X3IEHwQ4IKk6zcxdrUa
X8Zl4BEH+RFRE2M5NDMGBgJmDbHHsVBvDLS3wIofLmHq52fwa8FtqaMRUStS
YzkEBwfD2toaCoVCt62kpAQqlQrOzs5QqVS4efMmAODUqVMwMzODh4cHPDw8
8P777+vuExUVhd69e8PJyQlhYWG67RkZGRg8eDCcnZ0xbdo0PHjAt3UCgJ25
Kb56eSBWTnVHeuHvGL/mNNb/pOUgPyJqEjWWw5w5cxAVFVVlW1hYGHx9faHV
auHr61vlyX7EiBFITk5GcnIy3nvvPQDAo0ePsHDhQhw9ehSXLl3Cjh07cOnS
JQDA0qVLERoaCq1WC3Nzc2zbtq0h16fXBEHAiwPscDzUByoXG/wnOg3+6znI
j4gaX43l4O3tDQsLiyrbIiMjERQUBAAICgrCgQMH/vQYCQkJcHJygoODA4yN
jREYGIjIyEiIooiffvoJU6ZMqfWxWiOrDibYMGMAPp/liaLfHw/yCzvKQX5E
1HjqdM0hPz8fcrkcACCXy1FQUKC77cyZM3B3d4efnx9SU1MBALm5uejWrZtu
Hzs7O+Tm5qK4uBidOnWCTCarsp2ebKxLF5wI9cGUAXbYHJMOvzWxOHutWOpY
RNQCNegF6QEDBuD69es4f/483njjDUycOBEAnviefUEQnrr9acLDw6FUKqFU
KlFY2DrnEpmZGuGTKW74Zu5gPHxUiWnh8Vh2IAW37z+UOhoRtSB1KgcbGxvk
5T0e95CXlwdra2sAQMeOHdG+fXsAwPjx4/Hw4UMUFRXBzs4O2dnZuvvn5OTA
1tYWnTt3xq1bt1BRUVFl+9OEhIRAo9FAo9HAysqqLtFbjOHOnREd6o3gYT3x
zdnHg/xOXi2o+Y5ERLVQp3Lw9/dHREQEACAiIgIBAQEAgBs3bujOBhISElBZ
WQlLS0sMHDgQWq0WGRkZePDgAXbu3Al/f38IgoCRI0diz5491Y5FNTM1luG9
F/ph7/yhaGciw8tfnsOS75Nx8w7f8UVE9STWIDAwUOzSpYsok8nErl27ilu3
bhWLiorEUaNGiU5OTuKoUaPE4uJiURRFcd26dWK/fv1ENzc3cfDgwWJcXJzu
OIcPHxadnZ1FBwcH8cMPP9RtT09PFwcOHCg6OjqKU6ZMEe/fv19TJFEURdHT
07NW+7UW9x9WiJ8duyI6/v2wOOD9aPGH87liZWWl1LGIqJmp7XOnIIr6OcRH
qVRCo9FIHaPZuZxXhnf2XMDF3FKo+tngw4kK2HRsI3UsImomavvcyU9ItzB9
5R2xf8FQ/N2vD9RphRi9Mgbfn8viID8ieiYshxZIZmiAV30cEfWmN/rKO2Lp
3ouYufUssoo5yI+Iaofl0IL17NwOO+d54aNJClzIKcXY1WpsO81BfkRUM5ZD
C2dgIGDm4B44vsQbQxwt8cGhS5i86Wek5XOQHxE9HcuhlZCbtcW2ICXWBHrg
evEdPL82FmtOaPGggoP8iKg6lkMrIggCAjy64sQSH4xTyLHqRBr815/G+exb
UkcjomaG5dAKWbY3wbrp/bFlthI37z7ApI1x+NeRy7j3gIP8iOgxlkMrpupn
g+NLfDBtYHeEq6/Bb40aZ9I5yI+IWA6tXsc2Rvj4RVd8N28wRADTt8TjH/sv
ooyD/IhaNZYDAQCGOnZG1GJvzBvREzsTsjBmpRo/XcmXOhYRSYTlQDptjQ3x
7vP9sG/BMJi1NULwVxos3vkLin8vlzoaETUxlgNV49GtE354YzjeHO2MIxfz
oFqlRmRyLkdwELUiLAd6ImOZAd4c3QuH3hiBbhamWLwzGa9EaJBXek/qaETU
BFgO9Kd6d+mAffOH4n+e74u49CKMWanGd2ezUMkRHEQtGsuBamRoIOCVEQ44
9qY3FF3N8I/9FzFjazwyi+5IHY2IGgnLgWqth2U7fDdvMMJedEVqbhnGrVFj
i/oaB/kRtUAsB3omgiAgcFB3HF/ig+FOnfHRkct4cWMcrtwokzoaETUglgPV
SRezNtgyW4l10/sj5+Y9TFh7GiuPp6G8giM4iFoClgPVmSAIeMHdFseX+GCC
mxxrf9TihXWn8UvWTamjEVE9sRyo3izaGWN1YH98MUeJ2/cr8OKmn/HBoUu4
+6BC6mhEVEcsB2owo/rYIDrUGzMHd8e20xkYtzoWP/9aJHUsIqqDGsshODgY
1tbWUCgUum0lJSVQqVRwdnaGSqXCzZuPX0b49ttv4ebmBjc3NwwdOhTnz5/X
3cfe3h6urq7w8PCAUqms8Viknzq0McKHE12xM8QLBgIwY+tZ/G3vBZTe4yA/
In1SYznMmTMHUVFRVbaFhYXB19cXWq0Wvr6+CAsLAwD07NkTMTExuHDhApYt
W4aQkJAq9zt58iSSk5Oh0WhqPBbpNy8HS0S96Y1XfRywS5MN1coYRKfekDoW
EdVSjeXg7e0NCwuLKtsiIyMRFBQEAAgKCsKBAwcAAEOHDoW5uTkAwMvLCzk5
OTUGeNqxSP+1MTLE3/364sDCYbBoZ4yQrxPx+ndJKOIgP6Jmr07XHPLz8yGX
ywEAcrkcBQUF1fbZtm0b/Pz8dD8LgoAxY8bA09MT4eHhz3Qs0m9udp1w8PXh
eEvVC9Gp+Ri9Mgb7f8nhID+iZkzWGAc9efIktm3bhtOnT+u2xcXFwdbWFgUF
BVCpVOjTpw+8vb2f6bjh4eG6YiksLGzQzNS4jGUGeMPXGeMUXfDO3gsI/f48
Dib/ho8mucK2U1up4xHRf6nTmYONjQ3y8vIAAHl5ebC2ttbdduHCBbzyyiuI
jIyEpaWlbrutrS0AwNraGpMmTUJCQkKNx/pvISEh0Gg00Gg0sLKyqkt0kpiz
TQfseW0o3pvQD/HXSjBmlRpfx1/nID+iZqZO5eDv74+IiAgAQEREBAICAgAA
WVlZePHFF/H111+jV69euv3v3LmD27dv6/4cHR2te/fT045FLZehgYDg4T0R
HeoNj26dsOxACgK3xONa4e9SRyOi/yWINbzwO336dJw6dQpFRUWwsbHBihUr
MHHiREydOhVZWVno3r07du/eDQsLC7zyyivYu3cvevToAQCQyWTQaDS4du0a
Jk2aBACoqKjAjBkz8O677wIAiouLn3ismiiVyirveiL9JIoidmty8MHhS3hQ
UYlQVS+8MrwnZIb8CA5RY6jtc2eN5dBcsRxalvyy+1h2IAXRl/Kh6NoR/57s
jn62HaWORdTi1Pa5k7+eUbNg07ENPp/liY0zB+BG6X34rz+Nz6KvcpAfkURY
DtRsCIKA8a5yHA/1gb+HLdb99CueX3saidf5qXmipsZyoGbHvJ0xVk71wFcv
D8S9B48wZfPPWPFDKu6Uc5AfUVNhOVCz9VxvaxwL9cYsrx74Mi4TY1erEavl
51uImgLLgZq19iYyvB+gwK5Xh8DY0ACztiXg7d3nUXqXg/yIGhPLgfTCoJ4W
OLJ4BBY854h9v+Ri9KoYRKVwkB9RY2E5kN5oY2SId8b1QeTCYbBqb4LXvknE
gm8TUXD7vtTRiFoclgPpHUVXM0S+Pgxvj+2NE5cLoFqpxt5EDvIjakgsB9JL
RoYGWDjSCUcWjYCTdXu8tfs8gr48h5ybd6WORtQisBxIrzlZt8fuV4dghb8L
NJklGLtKje1nMjnIj6ieWA6k9wwMBAQNtcexN70xoIc53otMxdTPzyCdg/yI
6ozlQC1GNwtTbA8ehP+85A5twe/wWxOLDSd/xcNHlVJHI9I7LAdqUQRBwBRP
Oxxf4o3Rfa3x6bGrmLghDim5pVJHI9IrLAdqkaw7tMHGmZ7Y/JcByC8rR8CG
OPw76gruP+QgP6LaYDlQizZOIcePS3zwYv+u2HgqHePXxuJcZonUsYiaPZYD
tXhmpkb49CV3bA8ehPKHlXhp8xm8F5mC3znIj+ipWA7Uanj3skJ0qDfmDLXH
1/HXMXaVGjFpHORH9CQsB2pV2pnIsNzfBXteG4I2RgYI+iIBS3Yl49bdB1JH
I2pWWA7UKnn2sMDhRSPw+kgnHEz+DaNXxuDIxTypYxE1GywHarXaGBnir2N7
I/L1Yehi1gYLvk3Ca18noqCMg/yIWA7U6rnYmuHAgmFYOq4PfrpagNErY7BL
k81BftSq1aocgoODYW1tDYVCodtWUlIClUoFZ2dnqFQq3Lz5+Ht+RVHEokWL
4OTkBDc3NyQlJenuExERAWdnZzg7OyMiIkK3PTExEa6urnBycsKiRYv4j5Ka
nMzQAPOfc0TU4hHo06Uj3tlzAbO2JSC7hIP8qHWqVTnMmTMHUVFRVbaFhYXB
19cXWq0Wvr6+CAsLAwAcPXoUWq0WWq0W4eHhmD9/PoDHZbJixQqcPXsWCQkJ
WLFiha5Q5s+fj/DwcN39/vuxiJqKg1V77AzxwgcTFfgl6ybGrFLjy7gMPOIg
P2plalUO3t7esLCwqLItMjISQUFBAICgoCAcOHBAt3327NkQBAFeXl64desW
8vLycOzYMahUKlhYWMDc3BwqlQpRUVHIy8tDWVkZhgwZAkEQMHv2bN2xiKRg
YCBgllcPRC/xwWAHC6z44RJe2vwzfi24LXU0oiZT52sO+fn5kMvlAAC5XI6C
ggIAQG5uLrp166bbz87ODrm5uX+63c7Ortp2Iql17dQWX84ZiFXT3HGt6A7G
rzmN9T9pOciPWoUGvyD9pOsFgiA88/YnCQ8Ph1KphFKpRGEhP7xEjU8QBEzq
b4cTS3ygcrHBf6LT8MK607iYw0F+1LLVuRxsbGyQl/f4feF5eXmwtrYG8Pg3
/+zsbN1+OTk5sLW1/dPtOTk51bY/SUhICDQaDTQaDaysrOoaneiZdW5vgg0z
BuDzWZ4oufMAEzfG4eOjlznIj1qsOpeDv7+/7h1HERERCAgI0G3fvn07RFFE
fHw8zMzMIJfLMXbsWERHR+PmzZu4efMmoqOjMXbsWMjlcnTo0AHx8fEQRRHb
t2/XHYuouRnr0gXHl/hgygA7fB5zDX5rYnH2WrHUsYganlgLgYGBYpcuXUSZ
TCZ27dpV3Lp1q1hUVCSOGjVKdHJyEkeNGiUWFxeLoiiKlZWV4oIFC0QHBwdR
oVCI586d0x1n27ZtoqOjo+jo6Ch+8cUXuu3nzp0TXVxcRAcHB3HhwoViZWVl
jZk8PT1rE52o0ZzWForDP/lR7LH0kPju/gti2b0HUkciqlFtnzsFUdTPDxUo
lUpoNBqpY1Ard/dBBT6LTsMXcRmQd2yDjya5YmQfa6ljET1VbZ87+Qlponow
NZZh2YR+2Dt/KNqZyPDyV+cQ+n0ySu5wkB/pN5YDUQMY0N0chxYNxyJfZ/xw
/jeoVsbgh/O/8dP+pLdYDkQNxERmiCWqXvjhjeHoat4Wb+z4BfO2JyKfg/xI
D7EciBpYX3lH7Js/FP8Y3wex2kKMXhmDnQlZPIsgvcJyIGoEMkMDhHg74tib
3ugn74i/7buImVvPIquYg/xIP7AciBqRfed22DHPC/+a5IoLOaUYszoGW2Ov
cZAfNXssB6JGZmAgYMbg7ji+xBtDHTvjw8OXMXnTz0jL5yA/ar5YDkRNRG7W
FtuClFgT6IGskrt4fm0s1pzQ4kEFB/lR88NyIGpCgiAgwKMrjod6w08hx6oT
jwf5nc++JXU0oipYDkQSsGxvgrXT+2PrbCVK7z3EpI1x+OjwJdx7wEF+1Dyw
HIgkNLqfDaKXeCNwUHdsic3AuDVqnEnnID+SHsuBSGId2xjhX5Nc8d28wQCA
6Vvi8fd9F1F2/6HEyag1YzkQNRNDHTsjarE3Qrwd8P25LIxZqcaPl/OljkWt
FMuBqBlpa2yIf4zvi30LhsGsrRHmRmiwaMcvKP69XOpo1MqwHIiaIY9unfDD
G8MROroXjqbkYfTKGEQm53IEBzUZlgNRM2UsM8Di0c44vGgEeli2w+KdyXgl
QoO80ntSR6NWgOVA1Mz1sumAvfOH4n+e74u49CKoVqrx7dnrqOQIDmpELAci
PWBoIOCVEQ6IftMHbnZmeHd/CmZsjUdm0R2po1ELxXIg0iPdLU3x7SuDEfai
K1JzyzB2tRrh6nRUPOIIDmpYLAciPSMIAgIHdcfxJT4Y4WyFfx25gsmbfsaV
G2VSR6MWhOVApKe6mLXBltmeWD+jP3Ju3sOEtaex8ngayis4goPqr17lsGbN
GigUCri4uGD16tUAgGnTpsHDwwMeHh6wt7eHh4cHACAzMxNt27bV3fbaa6/p
jpOYmAhXV1c4OTlh0aJFfLseUS0JgoAJbrY4scQHL7jbYu2PWkxYexpJWTel
jkZ6TlbXO6akpGDLli1ISEiAsbExxo0bh+effx7ff/+9bp+33noLZmZmup8d
HR2RnJxc7Vjz589HeHg4vLy8MH78eERFRcHPz6+u0YhaHfN2xlg1zQP+7rb4
x/6LmLzpZwQP64m3xvSCqXGd/5lTK1bnM4fLly/Dy8sLpqamkMlk8PHxwf79
+3W3i6KIXbt2Yfr06X96nLy8PJSVlWHIkCEQBAGzZ8/GgQMH6hqLqFUb2cca
0aHemDm4O7adzsDY1WrE/VokdSzSQ3UuB4VCAbVajeLiYty9exdHjhxBdna2
7vbY2FjY2NjA2dlZty0jIwP9+/eHj48PYmNjAQC5ubmws7PT7WNnZ4fc3Ny6
xiJq9Tq0McKHE13xfYgXZAYGmLn1LP629wJK73GQH9Venc83+/bti6VLl0Kl
UqF9+/Zwd3eHTPb/D7djx44qZw1yuRxZWVmwtLREYmIiJk6ciNTU1CdeXxAE
4YmPGR4ejvDwcABAYWFhXaMTtQqDHSxxdPEIrD6hxZbYa/jpSgE+nKjAGJcu
UkcjPVCvC9Jz585FUlIS1Go1LCwsdGcJFRUV2LdvH6ZNm6bb18TEBJaWlgAA
T09PODo6Ii0tDXZ2dsjJydHtl5OTA1tb2yc+XkhICDQaDTQaDaysrOoTnahV
aGNkiL/59cGBBcNg2d4EIV8nYuF3SSi8zUF+9OfqVQ4FBQUAgKysLOzbt093
pnDixAn06dOnystFhYWFePTo8Vvsrl27Bq1WCwcHB8jlcnTo0AHx8fEQRRHb
t29HQEBAfWIR0X9xtTPDwdeH4a9jeuF4aj5Uq2Kw/5ccvjOQnqpeb2OYPHky
iouLYWRkhA0bNsDc3BwAsHPnzmoXotVqNd577z3IZDIYGhpi8+bNsLCwAABs
2rQJc+bMwb179+Dn58d3KhE1AiNDA7w+yhnjFF3wzp4LCP3+PCKTf8NHk1zR
tVNbqeNRMyOIevqrg1KphEajkToGkV56VCli+5lM/DvqKgwE4G/j+2LmoO4w
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
N7RabVNHbTC1WfO2bdswdepUAMCQIUNw//79Ws0P0me1/fdeZw16BaMZefjw
odizZ0/x2rVruotYKSkpVfZZv359lQvSL730khRRG0xt1pyUlCQ6ODiIaWlp
EqVsWLVZ8x/5+Pjo9QXp2qz36NGj4uzZs0VRFMXCwkLRzs5OLCoqkiJug6jN
mseNGyd++eWXoiiK4qVLl0S5XC5WVlZKkLZhZWRkPPWC9KFDh6pckB44cGCD
PnaLLQdRfHw139nZWXRwcBA//PBDURRFcdmyZWJkZKQoiqJ47949ccqUKaKj
o6M4cOBAMT09Xcq4DaKmNfv6+orW1taiu7u76O7uLr7wwgtSxm0QNa35j/S9
HESx5vVWVlaKoaGhYt++fUWFQiHu2LFDyrgNoqY1p6amikOHDhXd3NxEd3d3
8dixY1LGbRCBgYFily5dRJlMJnbt2lXcunWruGnTJnHTpk2iKD7+e16wYIHo
4OAgKhSKBv//mp+QJiKialrsNQciIqo7lgMREVXDciAiompYDkREVA3LgYiI
qmE5EBFRNSwHIiKqhuVARETV/D+itU987oBOrAAAAABJRU5ErkJggg==
" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-9-c0561d90d31a&gt;&quot;</span>, line <span style=" color:#006400;">200</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    train_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-9-c0561d90d31a&gt;&quot;</span>, line <span style=" color:#006400;">183</span>, in <span style=" color:#9400d3;">train_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    rnn.save('poetry_model/RNN_D30_M30_epochs2000_relu.npz')</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-9-c0561d90d31a&gt;&quot;</span>, line <span style=" color:#006400;">104</span>, in <span style=" color:#9400d3;">save</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/numpy/lib/npyio.py&quot;</span>, line <span style=" color:#006400;">603</span>, in <span style=" color:#9400d3;">savez</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    _savez(file, args, kwds, False)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/numpy/lib/npyio.py&quot;</span>, line <span style=" color:#006400;">695</span>, in <span style=" color:#9400d3;">_savez</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    zipf = zipfile_factory(file, mode=&quot;w&quot;, compression=compression)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/numpy/lib/npyio.py&quot;</span>, line <span style=" color:#006400;">112</span>, in <span style=" color:#9400d3;">zipfile_factory</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    return zipfile.ZipFile(file, *args, **kwargs)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;/home/myidispg/anaconda3/envs/nlp/lib/python3.6/zipfile.py&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">1113</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">__init__</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    self.fp = io.open(file, filemode)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">FileNotFoundError:</span> [Errno 2] No such file or directory: 'poetry_model/RNN_D30_M30_epochs2000_relu.npz'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">10</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">10</span><span style=" color:#00ff00;">]:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> Created on Thu Mar  7 20:21:15 2019</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> @author: myidispg</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import theano</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import theano.tensor as T</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import numpy as np</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import matplotlib.pyplot as plt</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> from sklearn.utils import shuffle</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> from util import init_weight, get_robert_frost</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> class SimpleRNN:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def __init__(self, D, M, V):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.D = D # Dimensionality of word embeddings</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.M = M # No. of hidden layers</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.V = V # Vocabulary size</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def fit(self, X, learning_rate=10e-1, mu=0.99, reg=1.0, activation=T.tanh, epochs=500, show_fig = False):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         N = len(X) # Number of training samples.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         D = self.D</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         M = self.M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V = self.V</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         # inital weights</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         We = init_weight(V, D)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wx = init_weight(D, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wh = init_weight(M, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bh = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         h0 = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wo = init_weight(M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bo = np.zeros(V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         cost = -T.mean(T.log(py_x[T.arange(thY.shape[0]), thY]))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         grads = T.grad(cost, self.params)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         dparams = [theano.shared(p.get_value()*0) for p in self.params]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         updates = [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 (p, p + mu*dp -  learning_rate*g) for p, dp, g in zip(self.params, dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             ] + [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     (dp, mu*dp - learning_rate*g) for dp, g in zip(dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.predict_op = theano.function(inputs=[thX], outputs=prediction)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.train_op = theano.function(inputs=[thX, thY], outputs=[cost, prediction], updates=updates)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         costs = []</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         n_total = sum((len(sentence) + 1) for sentence in X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         for i in range(epochs):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             X = shuffle(X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             n_correct = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             cost = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             for j in range(N):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 input_sequence = [0] + X[j]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 output_sequence = X[j] + [1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 c, p = self.train_op(input_sequence, output_sequence)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 cost += c</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 for pj, xj in zip(p, output_sequence):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     if pj == xj:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                         n_correct += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             print(f'epoch: {i}, cost: {cost}, correct_rate: {float(n_correct) / n_total}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             costs.append(cost)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         if show_fig:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             plt.plot(costs)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             plt.show()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def save(self, filename):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     @staticmethod</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def load(filename, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         npz = np.load(filename)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         We = npz['arr_0']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wx = npz['arr_1']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wh = npz['arr_2']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bh = npz['arr_3']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         h0 = npz['arr_4']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wo = npz['arr_5']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bo = npz['arr_6']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V, D = We.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         _, M = Wx.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         rnn = SimpleRNN(D, M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         return rnn</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def set_params(self, We, Wx, Wh, bh, h0, Wo, bo, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             )   </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.predict_op = theano.function(input=[thX], outputs=prediction, allow_input_downcast=True)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def generate(self, pi, word2idx):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         idx2word = {v:k for k, v in word2idx.iteritems()}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V = len(pi)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         n_lines = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         X = [ np.random.choice(V, p=pi)]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         print(idx2word[X[0]])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         while n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             P = self.predict_op(X)[-1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             X += [P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             if P &gt; 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 word = idx2word[P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             elif P == 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_lines += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 print('')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 if n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     X = [np.random.choice(V, p=pi) ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> def train_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn = SimpleRNN(30, 30, len(word2idx))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=2)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.save('RNN_D30_M30_epochs2_relu.npz')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.generate(pi, word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:53: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 0, cost: 10847.522250678207, correct_rate: 0.11586570111915734</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 1, cost: 9640.387770028388, correct_rate: 0.11816984858459513</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="data:image/png;base64,
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
I6oXLAeix2DT3hJLpw7A+hneuH6nEpPWHMbfv83CzYpKuaMRPRaWA1E9GPmE
PZIjffHi4B6IPZiDgGWpOPRjkdyxiOqM5UBUTzq2scA7E/rji3AfKMzM8OK6
o1i05STKbnGQHzU/LAeiejbYuQt2zR+BV/1csCUzD7roFCSf+VnuWESPhOVA
1ADaWJjjzbFPYPucYejSwQrhG49h7ueZKLzGQX7UPNRYDmFhYbC3t4e7u7tp
raSkBDqdDhqNBjqdDqWlv3xC47PPPoOHhwc8PDwwdOhQnDhxwvSYxMREuLq6
Qq1WIyoqyrSek5ODwYMHQ6PRYOrUqaioqKjP/RHJqr/KGjvmDcPvx/TB7jNX
oFuagm3f53GQHzV5NZbDjBkzkJiYeN9aVFQU/P39YTAY4O/vb3qx7927N1JS
UnDy5EksXrwY4eHhAIB79+5h7ty52LVrF7KysrBp0yZkZWUBABYtWoTIyEgY
DAbY2NggNja2vvdIJCsLczPMG6VBwvzhcO7aHpFfnMBLn2TAeJWD/KjpqrEc
fH19YWtre99afHw8QkNDAQChoaHYvn07AGDo0KGwsbEBAPj4+CAvLw8AkJ6e
DrVaDWdnZ1haWiIkJATx8fEQQmDfvn2YPHlytXMRtTRq+4746tWh+Ov4fjh6
oQRjolOw8chFDvKjJqlO9xyuXLkCpVIJAFAqlSgoKKh2TGxsLMaOHQsAMBqN
cHJyMv1MpVLBaDSiuLgYnTt3hkKhuG/9YWJiYqDVaqHValFYWFiX6ESyMjeT
8NKw3kiO9MWTPWywOP4MQmLScKHwutzRiO7TIDekv/vuO8TGxuL9998HgAe+
vypJ0kPXHyY8PBx6vR56vR52dnb1F5iokTnZtsPGmYPwz8ke+OHncgQuP4A1
+znIj5qOOpWDg4MD8vPzAQD5+fmwt7c3/ezkyZOYNWsW4uPj0aVLFwC/XBHk
5uaajsnLy4OjoyO6du2Kq1evorKy8r51otZAkiRM0Tphz0I/jHS1w/uJP2DC
6kPIusxBfiS/OpVDUFAQ4uLiAABxcXEIDg4GAFy6dAkTJ07Exo0b0adPH9Px
3t7eMBgMyMnJQUVFBTZv3oygoCBIkoSRI0diy5Yt1c5F1FrYd2qDj6ZpsebF
gfi57A6CVh7Ev5PO4fZdDvIjGYkahISEiG7dugmFQiG6d+8u1q1bJ4qKisSo
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
w3IgIqJq/h+k/CNMK4nEEgAAAABJRU5ErkJggg==
" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">11</span><span style=" color:#00ff00;">]:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> Created on Thu Mar  7 20:21:15 2019</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> @author: myidispg</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> &quot;&quot;&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import theano</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import theano.tensor as T</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import numpy as np</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> import matplotlib.pyplot as plt</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> from sklearn.utils import shuffle</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> from util import init_weight, get_robert_frost</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> class SimpleRNN:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def __init__(self, D, M, V):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.D = D # Dimensionality of word embeddings</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.M = M # No. of hidden layers</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.V = V # Vocabulary size</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def fit(self, X, learning_rate=10e-1, mu=0.99, reg=1.0, activation=T.tanh, epochs=500, show_fig = False):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         N = len(X) # Number of training samples.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         D = self.D</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         M = self.M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V = self.V</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         # inital weights</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         We = init_weight(V, D)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wx = init_weight(D, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wh = init_weight(M, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bh = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         h0 = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wo = init_weight(M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bo = np.zeros(V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         cost = -T.mean(T.log(py_x[T.arange(thY.shape[0]), thY]))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         grads = T.grad(cost, self.params)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         dparams = [theano.shared(p.get_value()*0) for p in self.params]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         updates = [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 (p, p + mu*dp -  learning_rate*g) for p, dp, g in zip(self.params, dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             ] + [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     (dp, mu*dp - learning_rate*g) for dp, g in zip(dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.predict_op = theano.function(inputs=[thX], outputs=prediction)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.train_op = theano.function(inputs=[thX, thY], outputs=[cost, prediction], updates=updates)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         costs = []</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         n_total = sum((len(sentence) + 1) for sentence in X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         for i in range(epochs):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             X = shuffle(X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             n_correct = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             cost = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             for j in range(N):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 input_sequence = [0] + X[j]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 output_sequence = X[j] + [1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 c, p = self.train_op(input_sequence, output_sequence)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 cost += c</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 for pj, xj in zip(p, output_sequence):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     if pj == xj:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                         n_correct += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             print(f'epoch: {i}, cost: {cost}, correct_rate: {float(n_correct) / n_total}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             costs.append(cost)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         if show_fig:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             plt.plot(costs)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             plt.show()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def save(self, filename):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     @staticmethod</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def load(filename, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         npz = np.load(filename)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         We = npz['arr_0']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wx = npz['arr_1']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wh = npz['arr_2']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bh = npz['arr_3']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         h0 = npz['arr_4']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wo = npz['arr_5']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bo = npz['arr_6']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V, D = We.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         _, M = Wx.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         rnn = SimpleRNN(D, M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         return rnn</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def set_params(self, We, Wx, Wh, bh, h0, Wo, bo, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             )   </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.predict_op = theano.function(input=[thX], outputs=prediction, allow_input_downcast=True)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def generate(self, pi, word2idx):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         idx2word = {v:k for k, v in word2idx.iteritems()}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V = len(pi)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         n_lines = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         X = [ np.random.choice(V, p=pi)]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         print(idx2word[X[0]])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         while n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             P = self.predict_op(X)[-1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             X += [P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             if P &gt; 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 word = idx2word[P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             elif P == 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_lines += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 print('')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 if n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     X = [np.random.choice(V, p=pi) ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> def train_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn = SimpleRNN(30, 30, len(word2idx))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.fit(sentences, learning_rate=10e-5, show_fig=True, activation=T.nnet.relu, epochs=200)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.save('RNN_D30_M30_epochs2_relu.npz')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.generate(pi, word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span> train_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:53: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 0, cost: 10851.138250332446, correct_rate: 0.11561882817643186</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 1, cost: 10003.928176316043, correct_rate: 0.11816984858459513</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 2, cost: 8818.794827037622, correct_rate: 0.12014483212639894</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 3, cost: 8452.947537887649, correct_rate: 0.1338051349572087</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 4, cost: 8309.340282326726, correct_rate: 0.13240618828176431</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 5, cost: 8253.472926384049, correct_rate: 0.1350394996708361</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 6, cost: 8197.128910709695, correct_rate: 0.13322909809084924</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 7, cost: 8155.997106700786, correct_rate: 0.1369321922317314</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 8, cost: 8129.345444010451, correct_rate: 0.1338051349572087</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 9, cost: 8079.21462303305, correct_rate: 0.13429888084265965</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 10, cost: 8049.517210783179, correct_rate: 0.1347926267281106</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 11, cost: 8010.249013632524, correct_rate: 0.1338051349572087</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 12, cost: 7984.367219503684, correct_rate: 0.13446346280447663</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 13, cost: 7943.3645876256105, correct_rate: 0.13512179065174457</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 14, cost: 7899.976179391112, correct_rate: 0.13528637261356155</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 15, cost: 7865.684499286969, correct_rate: 0.13512179065174457</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 16, cost: 7825.3145134708975, correct_rate: 0.1357801184990125</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 17, cost: 7794.159402153277, correct_rate: 0.13438117182356812</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 18, cost: 7756.943339725377, correct_rate: 0.1369321922317314</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 19, cost: 7721.274418331601, correct_rate: 0.1380019749835418</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 20, cost: 7684.410043952991, correct_rate: 0.13833113890717577</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 21, cost: 7645.709819069832, correct_rate: 0.13759052007899933</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 22, cost: 7614.882815445917, correct_rate: 0.1380842659644503</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 23, cost: 7574.880516158181, correct_rate: 0.13890717577353523</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 24, cost: 7544.945017907361, correct_rate: 0.1414581961816985</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 25, cost: 7503.5084991972835, correct_rate: 0.14170506912442396</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 26, cost: 7467.687104663913, correct_rate: 0.14269256089532587</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 27, cost: 7425.847373133736, correct_rate: 0.1423633969716919</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 28, cost: 7403.638307314443, correct_rate: 0.1421988150098749</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 29, cost: 7365.553207053595, correct_rate: 0.1434331797235023</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 30, cost: 7337.55241861584, correct_rate: 0.14326859776168532</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 31, cost: 7310.416816388533, correct_rate: 0.1426102699144174</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 32, cost: 7268.805692757018, correct_rate: 0.14433838051349573</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 33, cost: 7240.079190138417, correct_rate: 0.14474983541803818</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 34, cost: 7203.093750890819, correct_rate: 0.1455727452271231</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 35, cost: 7183.782828944077, correct_rate: 0.14433838051349573</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 36, cost: 7137.80149151589, correct_rate: 0.14705398288347596</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 37, cost: 7115.047903457666, correct_rate: 0.14713627386438446</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 38, cost: 7099.990859993483, correct_rate: 0.14433838051349573</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 39, cost: 7071.3842904806925, correct_rate: 0.14400921658986174</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 40, cost: 7037.877074576044, correct_rate: 0.14590190915075707</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 41, cost: 7015.686063688282, correct_rate: 0.14598420013166558</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 42, cost: 6983.867144582127, correct_rate: 0.14738314680710993</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 43, cost: 6957.287798045975, correct_rate: 0.14960500329163923</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 44, cost: 6924.028251859819, correct_rate: 0.14763001974983542</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 45, cost: 6906.199902140706, correct_rate: 0.14573732718894009</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 46, cost: 6883.178591385408, correct_rate: 0.14705398288347596</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 47, cost: 6853.305682214832, correct_rate: 0.14935813034891376</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 48, cost: 6834.401230435395, correct_rate: 0.14820605661619488</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 49, cost: 6808.831071408238, correct_rate: 0.1480414746543779</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 50, cost: 6795.119753800898, correct_rate: 0.14795918367346939</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 51, cost: 6766.569790079893, correct_rate: 0.14927583936800526</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 52, cost: 6751.4752035495385, correct_rate: 0.14935813034891376</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 53, cost: 6716.09663542957, correct_rate: 0.15075707702435814</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 54, cost: 6708.936225600849, correct_rate: 0.1489466754443713</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 55, cost: 6699.39893681192, correct_rate: 0.1468071099407505</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 56, cost: 6658.496285967341, correct_rate: 0.14828834759710335</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 57, cost: 6652.4476923030315, correct_rate: 0.1532258064516129</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 58, cost: 6628.816704789453, correct_rate: 0.1511685319289006</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 59, cost: 6615.001889527633, correct_rate: 0.15026333113890716</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 60, cost: 6592.8602156430525, correct_rate: 0.1499341672152732</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 61, cost: 6574.424483047501, correct_rate: 0.14861751152073732</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 62, cost: 6545.8600074517735, correct_rate: 0.15396642527978935</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 63, cost: 6536.586448048397, correct_rate: 0.15363726135615535</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 64, cost: 6531.100305614923, correct_rate: 0.15051020408163265</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 65, cost: 6505.514814083303, correct_rate: 0.15306122448979592</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 66, cost: 6482.7830278303, correct_rate: 0.1532258064516129</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 67, cost: 6464.220890332173, correct_rate: 0.15355497037524687</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 68, cost: 6440.054998745889, correct_rate: 0.1578341013824885</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 69, cost: 6417.919305875466, correct_rate: 0.1542132982225148</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 70, cost: 6404.503095378609, correct_rate: 0.1565997366688611</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 71, cost: 6380.354786039511, correct_rate: 0.15799868334430547</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 72, cost: 6354.93996536467, correct_rate: 0.1588215931533904</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 73, cost: 6350.551220169776, correct_rate: 0.15709348255431205</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 74, cost: 6327.91936953644, correct_rate: 0.16022053982883475</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 75, cost: 6309.921803364508, correct_rate: 0.15939763001974983</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 76, cost: 6300.648894328489, correct_rate: 0.15915075707702436</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 77, cost: 6272.658418234378, correct_rate: 0.15725806451612903</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 78, cost: 6235.4585471182945, correct_rate: 0.16170177748518763</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 79, cost: 6235.487952293087, correct_rate: 0.16384134298880842</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 80, cost: 6208.204383119174, correct_rate: 0.1620309414088216</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 81, cost: 6201.925677700947, correct_rate: 0.1619486504279131</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 82, cost: 6174.646720196554, correct_rate: 0.1641705069124424</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 83, cost: 6161.912606862128, correct_rate: 0.162936142198815</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 84, cost: 6142.897362369102, correct_rate: 0.1619486504279131</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 85, cost: 6132.317138471224, correct_rate: 0.16672152732060566</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 86, cost: 6094.99207155361, correct_rate: 0.16359447004608296</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 87, cost: 6080.691954799274, correct_rate: 0.16770901909150757</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 88, cost: 6070.811086119528, correct_rate: 0.16326530612244897</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 89, cost: 6054.858356917317, correct_rate: 0.16877880184331798</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 90, cost: 6028.123572860821, correct_rate: 0.17141211323238972</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 91, cost: 6024.49361294054, correct_rate: 0.16910796576695195</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 92, cost: 6002.429422950048, correct_rate: 0.17264647794601712</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 93, cost: 5979.011220225472, correct_rate: 0.1706714944042133</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 94, cost: 5960.4175418854065, correct_rate: 0.17322251481237658</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 95, cost: 5960.348956533848, correct_rate: 0.1729756418696511</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 96, cost: 5920.824415140693, correct_rate: 0.17626728110599077</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 97, cost: 5915.418166095881, correct_rate: 0.17560895325872283</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 98, cost: 5912.391045526622, correct_rate: 0.1759381171823568</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 99, cost: 5893.102470953932, correct_rate: 0.1750329163923634</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 100, cost: 5855.340588208673, correct_rate: 0.1803818301514154</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 101, cost: 5848.622947486605, correct_rate: 0.18219223173140223</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 102, cost: 5843.676527477714, correct_rate: 0.18054641211323239</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 103, cost: 5815.666862301571, correct_rate: 0.18449637919684003</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 104, cost: 5817.190923220351, correct_rate: 0.1815339038841343</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 105, cost: 5789.118214587177, correct_rate: 0.18499012508229098</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 106, cost: 5771.211992198967, correct_rate: 0.18622448979591838</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 107, cost: 5765.659965316887, correct_rate: 0.18614219881500987</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 108, cost: 5746.85134432447, correct_rate: 0.19009216589861752</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 109, cost: 5738.602345397737, correct_rate: 0.18589532587228438</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 110, cost: 5726.772296757832, correct_rate: 0.19198485845951282</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 111, cost: 5699.016842689348, correct_rate: 0.1924786043449638</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 112, cost: 5683.516845518065, correct_rate: 0.1967577353522054</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 113, cost: 5683.908093595245, correct_rate: 0.1911619486504279</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 114, cost: 5662.615207888234, correct_rate: 0.1989795918367347</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 115, cost: 5649.095419622683, correct_rate: 0.19470046082949308</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 116, cost: 5652.68536972222, correct_rate: 0.19749835418038184</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 117, cost: 5639.66550126662, correct_rate: 0.19478275181040158</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 118, cost: 5592.274564479048, correct_rate: 0.201201448321264</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 119, cost: 5601.186351850247, correct_rate: 0.20054312047399606</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 120, cost: 5583.831640158747, correct_rate: 0.20169519420671495</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 121, cost: 5570.360347526514, correct_rate: 0.20078999341672152</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 122, cost: 5570.873978755747, correct_rate: 0.2041639236339697</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 123, cost: 5563.412825652028, correct_rate: 0.20309414088215932</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 124, cost: 5536.190705577495, correct_rate: 0.20498683344305463</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 125, cost: 5534.56503261417, correct_rate: 0.20720868992758393</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 126, cost: 5527.662195057067, correct_rate: 0.20276497695852536</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 127, cost: 5501.091894950182, correct_rate: 0.20943054641211323</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 128, cost: 5516.832450798398, correct_rate: 0.2086899275839368</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 129, cost: 5479.586166398693, correct_rate: 0.21370967741935484</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 130, cost: 5472.027507904265, correct_rate: 0.21115865701119158</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 131, cost: 5448.657950766395, correct_rate: 0.21313364055299538</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 132, cost: 5443.980913409734, correct_rate: 0.21535549703752468</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 133, cost: 5428.8998931837905, correct_rate: 0.21576695194206716</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 134, cost: 5421.39542611878, correct_rate: 0.21831797235023043</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 135, cost: 5404.367705014037, correct_rate: 0.21782422646477945</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 136, cost: 5398.261278321416, correct_rate: 0.21691902567478605</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 137, cost: 5397.91715540205, correct_rate: 0.22128044766293614</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 138, cost: 5381.00734003022, correct_rate: 0.22111586570111916</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 139, cost: 5348.959689773626, correct_rate: 0.22630019749835417</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 140, cost: 5352.101294523822, correct_rate: 0.2207867017774852</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 141, cost: 5319.175013084547, correct_rate: 0.2228439763001975</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 142, cost: 5338.302182069869, correct_rate: 0.2228439763001975</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 143, cost: 5331.911771610897, correct_rate: 0.22169190256747862</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 144, cost: 5301.905364221259, correct_rate: 0.22794601711652404</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 145, cost: 5314.972905293286, correct_rate: 0.22588874259381173</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 146, cost: 5299.59359767336, correct_rate: 0.22572416063199474</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 147, cost: 5273.9393775704575, correct_rate: 0.23222514812376563</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 148, cost: 5271.604756647874, correct_rate: 0.22753456221198157</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 149, cost: 5242.661420032172, correct_rate: 0.23131994733377223</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 150, cost: 5237.483183038852, correct_rate: 0.2358459512837393</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 151, cost: 5240.762638566666, correct_rate: 0.22992100065832785</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 152, cost: 5207.022655766068, correct_rate: 0.23839697169190258</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 153, cost: 5221.672316258831, correct_rate: 0.2368334430546412</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 154, cost: 5210.466610693005, correct_rate: 0.2325543120473996</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 155, cost: 5188.387208879022, correct_rate: 0.24201777485187623</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 156, cost: 5178.940530901236, correct_rate: 0.24226464779460172</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 157, cost: 5162.738120329526, correct_rate: 0.24061882817643188</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 158, cost: 5157.607490542126, correct_rate: 0.24275839368005267</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 159, cost: 5139.486028361543, correct_rate: 0.2467083607636603</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 160, cost: 5172.755462415008, correct_rate: 0.23872613561553654</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 161, cost: 5124.847217081687, correct_rate: 0.2467083607636603</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 162, cost: 5118.998386647958, correct_rate: 0.24703752468729429</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 163, cost: 5095.526929974908, correct_rate: 0.24736668861092825</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 164, cost: 5100.679028186923, correct_rate: 0.2467906517445688</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 165, cost: 5123.6381668592185, correct_rate: 0.24498025016458197</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 166, cost: 5104.627141346869, correct_rate: 0.24868334430546413</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 167, cost: 5077.610326365927, correct_rate: 0.24909479921000657</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 168, cost: 5078.680367828413, correct_rate: 0.2509874917709019</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 169, cost: 5099.786998146958, correct_rate: 0.24950625411454905</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 170, cost: 5048.322269585159, correct_rate: 0.2543614219881501</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 171, cost: 5033.98283426528, correct_rate: 0.25617182356813695</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 172, cost: 5030.73521539406, correct_rate: 0.25699473337722184</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 173, cost: 5038.099916416665, correct_rate: 0.2563364055299539</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 174, cost: 5014.9048587824545, correct_rate: 0.2552666227781435</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 175, cost: 5016.602766460217, correct_rate: 0.25666556945358787</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 176, cost: 4987.7106868672945, correct_rate: 0.2577353522053983</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 177, cost: 4989.194936062617, correct_rate: 0.26143844634628044</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 178, cost: 4990.122789556153, correct_rate: 0.2557603686635945</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 179, cost: 4969.577163603074, correct_rate: 0.2607801184990125</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 180, cost: 4954.369344575913, correct_rate: 0.26341342988808425</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 181, cost: 4952.190753680332, correct_rate: 0.2629196840026333</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 182, cost: 4934.558604292373, correct_rate: 0.26703423304805796</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 183, cost: 4916.977916351214, correct_rate: 0.2666227781435155</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 184, cost: 4901.550118496534, correct_rate: 0.2725477287689269</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 185, cost: 4948.73969598731, correct_rate: 0.2617676102699144</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 186, cost: 4913.204336675921, correct_rate: 0.2685154707044108</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 187, cost: 4925.973603881151, correct_rate: 0.2643186306780777</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 188, cost: 4893.949955639347, correct_rate: 0.2706550362080316</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 189, cost: 4880.276363760694, correct_rate: 0.27230085582620145</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 190, cost: 4884.183589712612, correct_rate: 0.27378209348255433</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 191, cost: 4858.142058711847, correct_rate: 0.2760862409479921</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 192, cost: 4846.650146971258, correct_rate: 0.27657998683344304</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 193, cost: 4841.325721378223, correct_rate: 0.27369980250164583</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 194, cost: 4866.397315017206, correct_rate: 0.2686800526662278</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 195, cost: 4815.549676965298, correct_rate: 0.2771560236998025</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 196, cost: 4821.563828301361, correct_rate: 0.2778966425279789</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 197, cost: 4784.908194562704, correct_rate: 0.2852205398288348</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 198, cost: 4814.286473970503, correct_rate: 0.2764154048716261</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">epoch: 199, cost: 4787.102370564379, correct_rate: 0.2781435154707044</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="data:image/png;base64,
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
DVcEhYX/egxmUVERERERzbY3Zfbs2eTm5pKbm0toaOjllu52rEH+pN0znP/7
6VCqauq4/f+2sDDzS4orz7i6NBHpYC47HN544w1nlxJAcnKy846jtLQ0Jk+e
7Gxfvnw5pmmydetWgoKCsFqtJCUlsW7dOioqKqioqGDdunUkJSVdblnSDMMw
mBhnZc380dw61MYfN+3nusUf8OCft7P78AlXlyciHcRl3a1UVVVFZGQk+/fv
JygoCICysjKmTp3KoUOH6NmzJytWrMBisWCaJj//+c/JysoiICCAZcuWkZCQ
AMCrr77K7373OwD+67/+i3vuueein627lVpHYXkV6dsOsXzLQU5V15IyKoqH
b7iGLn7eri5NRNrApZ47W+VWVldQOLSu42fO8Yd1e/jz1oP4eXnyb0Mi+Nl4
O7bgAFeXJiKt6FLPnV7tUItcAYL8vfnvyXFMGx7Jn7cc5O95xfw9r5ibB1px
DAgnKbY7Hh5N3yggIlcfLZ8h54mNCGLRbfFs/OU4bhtq44M9R5nzeh63vPwJ
m/NLdQusiJtQOEiTIrr6s/DWgWz/jYNnpw2iuOIMdy3NYeTvNpD1RYmryxOR
NqZuJbkgTw+DW4bYmBhrZVN+Kf/7j6958C95jO8bysAeQfSzdmFEbwshnX1d
XaqItCKFg1wSfx9PkmK7M75vGM+u38u6Xd/w4d5S6k0IDvDmlZQEhvWyuLpM
EWklultJWuzsuTq+KD7OL1fs5HDlWWJ7dGFIZDD3j+mNNcjf1eWJSBPadeE9
cU9+3p4kRFl4e+61TB8Ria+XB8u3HGDs7zdyX9o2/r69iJpaDWCLXInUrSSX
zdLJh/+eHAc0TKp79eMC3t99hPVfHuWZ9/cyZ1wfbk+w4evl6eJKReRSqVtJ
2oRpmmzcW8oLG/LZcaiS7l38eHBsNDcPitDgtYgLaYa0dAimafLx12U8v2Ev
2w40PBUwNNAXW7A/P+4fzt0/iqKTry5gRdqLZkhLh2AYBtfFhHCtvRufFlaS
e6CCvUdOsq/0FE+v3cOrHxUwZ1wffprYCz9vdTuJdBQKB2kXhmEwpGcwQ3r+
6/Gv2w9W8Mz7e3hq9Ze8sCGfW4fauG90b63nJNIBKBzEZYb1Cub1+xLJKSjn
9eyDvJ59kL9sPciUYTbmjrPTs5tCQsRVFA7iciN6WxjR28KjE/vxxw/38ca2
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
2rXtWte0adOcNUVFRTF48GCgfY9Xc+eHdv2OmW6itrbWjI6ONvft22dWV1eb
8fHx5q5du1xWz+HDh83t27ebpmmaJ06cMGNiYsxdu3aZv/3tb82nn37aZXWZ
pmn26tXLLC0tPa/tV7/6lblw4ULTNE1z4cKF5iOPPOKK0kzTbPhdhoeHmwcO
HHDZ8frwww/N7du3m7Gxsc625o7R6tWrzYkTJ5r19fXmli1bzBEjRrRrXWvX
rjXPnTtnmqZpPvLII866CgoKztuuLTVVV3O/u127dpnx8fHm2bNnzf3795vR
0dFmbW1tu9X1XQ8//LC5YMEC0zTb93g1d35oz++Y21w55OTkYLfbiY6OxsfH
h+nTp5ORkeGyeqxWK0OHDgUgMDCQ/v37U1xc7LJ6LiYjI4OUlBQAUlJSWLly
pctq2bBhA3369KFXr14uq2HMmDFYLJbz2po7RhkZGcycORPDMEhMTKSyspKS
kpJ2q+uGG27Ay6vhoY+JiYkUFRW1yWf/0Lqak5GRwfTp0/H19aV3797Y7XZy
cnLavS7TNHnzzTeZMWNGm3z2hTR3fmjP75jbhENxcTGRkZHO1zabrcOcjA8c
OMCOHTsYOXIkAC+99BLx8fHce++97d59A2AYBjfccAPDhg0jNTUVgCNHjmC1
WoGGL+7Ro0fbva5vpaenn/cP1tXH61vNHaOO9N179dVXufHGG52vCwoKGDJk
CGPHjmXz5s3tXk9Tv7uOcrw2b95MeHg4MTExzjZXHK/vnh/a8zvmNuFgNnFT
lmEYLqjkfKdOneK2227jueeeo0uXLsyZM4d9+/bx6aefYrVa+cUvftHuNX38
8cfk5eWxZs0alixZwqZNm9q9hubU1NSwatUqbr/9doAOcbwupqN89/7nf/4H
Ly8v7rzzTqDh5HLo0CF27NjBM888wx133MGJEyfarZ7mfncd5Xi98cYb5/0R
4orj9f3zQ3Pa4pi5TTjYbDYKCwudr4uKioiIiHBhRXDu3Dluu+027rzzTm69
9VYAwsPD8fT0xMPDg/vvv7/NLqcv5NvjEhYWxi233EJOTg7h4eHOy9SSkhLC
wsLavS6ANWvWMHToUMLDGx643hGO17eaO0Yd4buXlpbGe++9x+uvv+48afj6
+tKtWzeg4X75Pn36sHfv3narqbnfXUc4XrW1tbz99ttMmzbN2dbex6u580N7
fcfcJhyGDx9Ofn4+BQUF1NTUkJ6eTnJyssvqMU2TWbNm0b9/fx5++GFn+3f7
Cd95553z7qJoD6dPn+bkyZPO/1+3bh1xcXEkJyeTlpYGNJxoJk+e3K51fev7
f825+nh9V3PHKDk5meXLl2OaJlu3biUoKMjZNdAesrKyWLx4MatWrSIgIMDZ
XlpaSl1dHQD79+8nPz+f6Ojodqurud9dcnIy6enpVFdXU1BQQH5+PiNGjGi3
ugDWr19Pv379sNlszrb2PF7NnR/a9Tt22UPaV5DVq1ebMTExZnR0tPnUU0+5
tJbNmzebgDlw4EBz0KBB5qBBg8zVq1ebP/3pT824uDhz4MCB5k9+8hPz8OHD
7VrXvn37zPj4eDM+Pt4cMGCA8zgdO3bMvP7660273W5ef/31ZllZWbvWZZqm
efr0adNisZiVlZXONlcdr+nTp5vdu3c3vby8zB49epivvPJKs8eovr7enDt3
rhkdHW3GxcWZ27Zta9e6+vTpY9psNuf37IEHHjBN0zTfeustc8CAAWZ8fLw5
ZMgQc9WqVe1a14V+d0899ZQZHR1tXnPNNWZmZma71mWappmSkmK+/PLL523b
nserufNDe37HNENaREQacZtuJRERuXQKBxERaUThICIijSgcRESkEYWDiIg0
onAQEZFGFA4iItKIwkFERBr5/xL3KePPZIeDAAAAAElFTkSuQmCC
" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">12</span><span style=" color:#00ff00;">]:</span> generate_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-12-004d04744a45&gt;&quot;</span>, line <span style=" color:#006400;">1</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    generate_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-11-af78badca239&gt;&quot;</span>, line <span style=" color:#006400;">188</span>, in <span style=" color:#9400d3;">generate_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    rnn = SimpleRNN.load('poetry_model/RNN_D30_M30_epochs2000_relu.npz', T.nnet.relu)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-11-af78badca239&gt;&quot;</span>, line <span style=" color:#006400;">108</span>, in <span style=" color:#9400d3;">load</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    npz = np.load(filename)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/numpy/lib/npyio.py&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">384</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">load</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    fid = open(file, &quot;rb&quot;)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">FileNotFoundError:</span> [Errno 2] No such file or directory: 'poetry_model/RNN_D30_M30_epochs2000_relu.npz'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">13</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">13</span><span style=" color:#00ff00;">]:</span> def generate_poetry():</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     sentences, word2idx = get_robert_frost()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn = SimpleRNN.load('RNN_D30_M30_epochs200_relu.npz', T.nnet.relu)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     # Create the initial word distribution.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     V = len(word2idx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     pi = np.zeros(V) # creates a vector of length V.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     for sentence in sentences:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         pi[sentence[0]] += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     pi /= pi.sum()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     rnn.generate(pi, word2idx)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">14</span><span style=" color:#00ff00;">]:</span> generate_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:141: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-14-004d04744a45&gt;&quot;</span>, line <span style=" color:#006400;">1</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    generate_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-13-b7e8954d2a6e&gt;&quot;</span>, line <span style=" color:#006400;">3</span>, in <span style=" color:#9400d3;">generate_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    rnn = SimpleRNN.load('RNN_D30_M30_epochs200_relu.npz', T.nnet.relu)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-11-af78badca239&gt;&quot;</span>, line <span style=" color:#006400;">119</span>, in <span style=" color:#9400d3;">load</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-11-af78badca239&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">154</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">set_params</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    self.predict_op = theano.function(input=[thX], outputs=prediction, allow_input_downcast=True)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">TypeError:</span> function() got an unexpected keyword argument 'input'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">15</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">15</span><span style=" color:#00ff00;">]:</span> class SimpleRNN:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def __init__(self, D, M, V):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.D = D # Dimensionality of word embeddings</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.M = M # No. of hidden layers</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.V = V # Vocabulary size</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def fit(self, X, learning_rate=10e-1, mu=0.99, reg=1.0, activation=T.tanh, epochs=500, show_fig = False):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         N = len(X) # Number of training samples.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         D = self.D</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         M = self.M</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V = self.V</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         # inital weights</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         We = init_weight(V, D)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wx = init_weight(D, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wh = init_weight(M, M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bh = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         h0 = np.zeros(M)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wo = init_weight(M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bo = np.zeros(V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             )</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         print(f'y.shape: {y.shape}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         cost = -T.mean(T.log(py_x[T.arange(thY.shape[0]), thY]))</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         grads = T.grad(cost, self.params) # returns gradient of cost with all params</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         dparams = [theano.shared(p.get_value()*0) for p in self.params]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         updates = [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 (p, p + mu*dp - learning_rate*g) for p, dp, g in zip(self.params, dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             ] + [</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     (dp, mu*dp - learning_rate*g) for dp, g in zip(dparams, grads)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     ]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.predict_op = theano.function(inputs=[thX], outputs=prediction)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.train_op = theano.function(inputs=[thX, thY], outputs=[cost, prediction], updates=updates)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         costs = []</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         n_total = sum((len(sentence) + 1) for sentence in X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         for i in range(epochs):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             X = shuffle(X)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             n_correct = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             cost = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             for j in range(N):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 input_sequence = [0] + X[j]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 output_sequence = X[j] + [1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 c, p = self.train_op(input_sequence, output_sequence)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 cost += c</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 for pj, xj in zip(p, output_sequence):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     if pj == xj:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                         n_correct += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             print(f'epoch: {i}, cost: {cost}, correct_rate: {float(n_correct) / n_total}')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             costs.append(cost)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         if show_fig:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             plt.plot(costs)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             plt.show()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def save(self, filename):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         np.savez(filename, *[p.get_value() for p in self.params])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     @staticmethod</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def load(filename, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         npz = np.load(filename)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         We = npz['arr_0']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wx = npz['arr_1']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wh = npz['arr_2']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bh = npz['arr_3']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         h0 = npz['arr_4']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Wo = npz['arr_5']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         bo = npz['arr_6']</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V, D = We.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         _, M = Wx.shape</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         rnn = SimpleRNN(D, M, V)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         rnn.set_params(We, Wx, Wh, bh, h0, Wo, bo, activation)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         return rnn</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def set_params(self, We, Wx, Wh, bh, h0, Wo, bo, activation):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.f = activation</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.We = theano.shared(We)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wx = theano.shared(Wx)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wh = theano.shared(Wh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bh = theano.shared(bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.h0 = theano.shared(h0)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.Wo = theano.shared(Wo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.bo = theano.shared(bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.params = [self.We, self.Wx, self.Wh, self.bh, self.h0, self.Wo, self.bo]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thX = T.ivector('X') # sequence of indexes.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         Ei = self.We[thX] # returns a TxD matrix</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         thY = T.ivector('Y')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         def recurrence(x_t, h_t1):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             # returns h(t), y(t)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             h_t = self.f(x_t.dot(self.Wx) + h_t1.dot(self.Wh) + self.bh)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             y_t = T.nnet.softmax(h_t.dot(self.Wo) + self.bo)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             return h_t, y_t</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         [h, y], _ = theano.scan(</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 fn=recurrence,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 outputs_info=[self.h0, None],</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 sequences=Ei,</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_steps=Ei.shape[0]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             )   </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         py_x = y[:, 0, :]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         prediction = T.argmax(py_x, axis=1)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         self.predict_op = theano.function(inputs=[thX], outputs=prediction, allow_input_downcast=True)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     def generate(self, pi, word2idx):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         idx2word = {v:k for k, v in word2idx.iteritems()}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         V = len(pi)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         n_lines = 0</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         X = [ np.random.choice(V, p=pi)]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         print(idx2word[X[0]])</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>         while n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             P = self.predict_op(X)[-1]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             X += [P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             if P &gt; 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 word = idx2word[P]</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>             elif P == 1:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 n_lines += 1</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 print('')</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                 if n_lines &lt; 4:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>                     X = [np.random.choice(V, p=pi) ]</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">16</span><span style=" color:#00ff00;">]:</span> generate_poetry()</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">__main__:128: UserWarning: DEPRECATION: If x is a vector, Softmax will not automatically pad x anymore in next releases. If you need it, please do it manually. The vector case is gonna be supported soon and the output will be a vector.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">/home/myidispg/anaconda3/envs/nlp/lib/python3.6/site-packages/theano/scan_module/scan_perform_ext.py:76: UserWarning: The file scan_perform.c is not available. This donot happen normally. You are probably in a strangesetup. This mean Theano can not use the cython code for scan. If youwant to remove this warning, use the Theano flag'cxx=' (set to an empty string) to disable all ccode generation.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  &quot;The file scan_perform.c is not available. This do&quot;</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-16-004d04744a45&gt;&quot;</span>, line <span style=" color:#006400;">1</span>, in <span style=" color:#9400d3;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    generate_poetry()</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  File <span style=" color:#006400;">&quot;&lt;ipython-input-13-b7e8954d2a6e&gt;&quot;</span>, line <span style=" color:#006400;">12</span>, in <span style=" color:#9400d3;">generate_poetry</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    rnn.generate(pi, word2idx)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-15-7f4754cb70cc&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">144</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">generate</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    idx2word = {v:k for k, v in word2idx.iteritems()}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">AttributeError:</span> 'dict' object has no attribute 'iteritems'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">17</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">17</span><span style=" color:#00ff00;">]:</span> from future.utils import iteritems</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Traceback <span style=" color:#00ffff;">(most recent call last)</span>:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ffff;">  File </span><span style=" color:#00ff00;">&quot;&lt;ipython-input-17-086e6f370107&gt;&quot;</span><span style=" color:#00ffff;">, line </span><span style=" color:#00ff00;">1</span><span style=" color:#00ffff;">, in </span><span style=" color:#ff00ff;">&lt;module&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ffff00;">    from future.utils import iteritems</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#ff0000;">ModuleNotFoundError:</span> No module named 'future'</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">18</span><span style=" color:#00ff00;">]:</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">In [</span><span style=" font-weight:600; color:#00ff00;">18</span><span style=" color:#00ff00;">]:</span> for k, y in word2idx:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#00ff00;">    ...:</span>     print(f'k: {k}; v: {v}')</p></body></html>